<!doctype html><html class="antialiased scroll-smooth scroll-pt-14" lang=vi><meta charset=utf-8><title>Javascript: Promise | manhhomienbienthuy</title><meta content="width=device-width,initial-scale=1" name=viewport><link href=https://manhhomienbienthuy.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=https://manhhomienbienthuy.github.io/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=https://manhhomienbienthuy.github.io/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=https://manhhomienbienthuy.github.io/site.webmanifest rel=manifest><link color=#5bbad5 href=https://manhhomienbienthuy.github.io/safari-pinned-tab.svg rel=mask-icon><meta content=#da532c name=msapplication-TileColor><meta content=#ffffff name=theme-color><link href=https://manhhomienbienthuy.github.io/2018/06/20/javascript-promise.html rel=canonical><meta content=https://manhhomienbienthuy.github.io/icon-tile.png name=msapplication-TileImage><meta content=on name=twitter:dnt><meta content=manhhomienbienthuy name=Author><meta content=general name=rating><meta content=product name=twitter:card><meta content=@_naa_4f name=twitter:site><meta content=@_naa_4f name=twitter:creator><link title="manhhomienbienthuy Full RSS Feed" href=https://manhhomienbienthuy.github.io/feeds/rss.xml rel=alternate type=application/rss+xml><link title="manhhomienbienthuy Full Atom Feed" href=https://manhhomienbienthuy.github.io/feeds/atom.xml rel=alternate type=application/atom+xml><meta content="JavaScript là một ngôn ngữ lập trình phía client, giúp chúng ta có những ứng dụng web đẹp hơn, thao tác dễ hơn, hiệu ứng cool hơn. Tuy nhiên, cách thức hoạt động của JavaScript hơi đặc thù một chút. Rất nhiều hoạt động của nó đều ở dạng bất […]" name=description><meta content="Javascript: Promise | manhhomienbienthuy" name=twitter:title><meta content="JavaScript là một ngôn ngữ lập trình phía client, giúp chúng ta có những ứng dụng web đẹp hơn, thao tác dễ hơn, hiệu ứng cool hơn. Tuy nhiên, cách thức hoạt động của JavaScript hơi đặc thù một chút. Rất nhiều hoạt động của nó đều ở dạng bất […]" name=twitter:description><meta content=https://cdn.pixabay.com/photo/2014/04/21/20/09/pinky-swear-329329_1280.jpg name=twitter:image><link href=https://manhhomienbienthuy.github.io/theme/css/syntax.css rel=stylesheet><link href=https://manhhomienbienthuy.github.io/theme/css/app.css rel=stylesheet><script>document.documentElement.classList.toggle(`dark`,localStorage.theme===`dark`||!(`theme` in localStorage)&&window.matchMedia(`(prefers-color-scheme: dark)`).matches)</script><body class="text-slate-600 bg-slate-100 dark:bg-slate-700 dark:text-slate-300"><header class=mb-8><div class="fixed z-50 top-0 left-0 right-0 text-white bg-slate-900"><div class="relative flex flex-wrap justify-between items-center gap-x-4 container mx-auto px-4"><a class="my-2.5 rounded-full" href=https://manhhomienbienthuy.github.io> <img class="size-5 rounded-full" alt=manhhomienbienthuy height=20 src=https://manhhomienbienthuy.github.io/meow.webp width=20> </a><input class="hidden peer" id=menu-toggle type=checkbox><label class="grow flex items-center gap-x-0.5 md:hidden text-xs cursor-pointer" for=menu-toggle><svg viewbox="0 0 24 24" class=size-5 fill=none stroke=currentColor xmlns=http://www.w3.org/2000/svg><path d="M4 6h16M4 12h16M4 18h16" stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> <span class=uppercase>Menu</span></label><nav class="hidden peer-checked:block md:block grow order-last md:order-none w-full md:w-auto text-xs uppercase bg-slate-900 divide-y md:divide-y-0"><a class="block md:inline p-4" href=https://manhhomienbienthuy.github.io> Trang chủ </a><a class="block md:inline p-4" href=https://manhhomienbienthuy.github.io/category/cuoc-song.html> Cuộc sống </a><a class="block md:inline p-4" href=https://manhhomienbienthuy.github.io/category/du-lich.html> Du lịch </a><a class="block md:inline p-4" href=https://manhhomienbienthuy.github.io/category/lap-trinh.html> Lập trình </a><a class="block md:inline p-4" href=https://manhhomienbienthuy.github.io/category/tong-hop.html> Tổng hợp </a></nav><div><input class="hidden peer" id=theme-toggle type=checkbox><label class="size-5 text-slate-400 dark:text-slate-500 cursor-pointer" for=theme-toggle><span class=dark:hidden> <svg viewbox="0 0 24 24" class=size-5 fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/><path d="M12 4v1M17.66 6.344l-.828.828M20.005 12.004h-1M17.66 17.664l-.828-.828M12 20.01V19M6.34 17.664l.835-.836M3.995 12.004h1.01M6 6l.835.836"/></svg> </span> <span class="hidden dark:inline"> <svg viewbox="0 0 24 24" class=size-5 fill=currentColor><path d="m17.715 15.15.95.316a1 1 0 0 0-1.445-1.185l.495.869ZM9 6.035l.846.534a1 1 0 0 0-1.14-1.49L9 6.035Zm8.221 8.246a5.47 5.47 0 0 1-2.72.718v2a7.47 7.47 0 0 0 3.71-.98l-.99-1.738Zm-2.72.718A5.5 5.5 0 0 1 9 9.5H7a7.5 7.5 0 0 0 7.5 7.5v-2ZM9 9.5c0-1.079.31-2.082.845-2.93L8.153 5.5A7.47 7.47 0 0 0 7 9.5h2Zm-4 3.368C5 10.089 6.815 7.75 9.292 6.99L8.706 5.08C5.397 6.094 3 9.201 3 12.867h2Zm6.042 6.136C7.718 19.003 5 16.268 5 12.867H3c0 4.48 3.588 8.136 8.042 8.136v-2Zm5.725-4.17c-.81 2.433-3.074 4.17-5.725 4.17v2c3.552 0 6.553-2.327 7.622-5.537l-1.897-.632Z"/><path d="M17 3a1 1 0 0 1 1 1 2 2 0 0 0 2 2 1 1 0 1 1 0 2 2 2 0 0 0-2 2 1 1 0 1 1-2 0 2 2 0 0 0-2-2 1 1 0 1 1 0-2 2 2 0 0 0 2-2 1 1 0 0 1 1-1Z" clip-rule=evenodd fill-rule=evenodd /></svg> </span></label><ul class="hidden peer-checked:block absolute z-50 top-full right-2 w-36 mt-2 py-1 text-sm font-semibold bg-slate-100 dark:bg-slate-900 text-slate-400 dark:text-slate-500 rounded-lg shadow-lg overflow-hidden cursor-pointer"><li class="py-1 px-2 flex items-center" data-mode=light><svg class="size-6 mr-2" viewbox="0 0 24 24" fill=none stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2><path d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/><path d="M12 4v1M17.66 6.344l-.828.828M20.005 12.004h-1M17.66 17.664l-.828-.828M12 20.01V19M6.34 17.664l.835-.836M3.995 12.004h1.01M6 6l.835.836"/></svg> Light<li class="py-1 px-2 flex items-center cursor-pointer" data-mode=dark><svg class="size-6 mr-2" viewbox="0 0 24 24" fill=currentColor><path d="m17.715 15.15.95.316a1 1 0 0 0-1.445-1.185l.495.869ZM9 6.035l.846.534a1 1 0 0 0-1.14-1.49L9 6.035Zm8.221 8.246a5.47 5.47 0 0 1-2.72.718v2a7.47 7.47 0 0 0 3.71-.98l-.99-1.738Zm-2.72.718A5.5 5.5 0 0 1 9 9.5H7a7.5 7.5 0 0 0 7.5 7.5v-2ZM9 9.5c0-1.079.31-2.082.845-2.93L8.153 5.5A7.47 7.47 0 0 0 7 9.5h2Zm-4 3.368C5 10.089 6.815 7.75 9.292 6.99L8.706 5.08C5.397 6.094 3 9.201 3 12.867h2Zm6.042 6.136C7.718 19.003 5 16.268 5 12.867H3c0 4.48 3.588 8.136 8.042 8.136v-2Zm5.725-4.17c-.81 2.433-3.074 4.17-5.725 4.17v2c3.552 0 6.553-2.327 7.622-5.537l-1.897-.632Z"/><path d="M17 3a1 1 0 0 1 1 1 2 2 0 0 0 2 2 1 1 0 1 1 0 2 2 2 0 0 0-2 2 1 1 0 1 1-2 0 2 2 0 0 0-2-2 1 1 0 1 1 0-2 2 2 0 0 0 2-2 1 1 0 0 1 1-1Z" clip-rule=evenodd fill-rule=evenodd /></svg> Dark<li class="py-1 px-2 flex items-center cursor-pointer text-sky-500" data-mode=system><svg class="size-6 mr-2 text-slate-400 dark:text-slate-500" viewbox="0 0 24 24" fill=none stroke=currentColor stroke-width=2 xmlns=http://www.w3.org/2000/svg><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" stroke-linecap=round stroke-linejoin=round /><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" stroke-linecap=round stroke-linejoin=round /></svg> System</ul></div></div></div><div class="pt-10 md:pt-12 bg-white shadow-sm dark:bg-slate-800 dark:text-slate-100"><div class="flex justify-center container mx-auto px-6 py-4"><a href=https://manhhomienbienthuy.github.io title=manhhomienbienthuy> <svg class="max-w-full max-h-24 w-auto h-auto text-slate-900 dark:text-slate-100" viewbox="0 0 1000 165" fill=currentColor height=165 version=1.0 width=1000 xmlns=http://www.w3.org/2000/svg><path d="M651.5 14.7c-10.4 1-11.6 1.4-11 3.3.9 2.9-1.2 7-17.6 34.2-8.4 13.9-17.6 30.2-20.4 36.3-3.5 7.4-6.7 12.4-9.6 15.4-6.1 6.1-13.9 9.2-13.9 5.6 0-2.6 4.7-11 12.7-22.8C600.3 74 602 70.5 602 65.5c0-5.2-2.8-7.5-9-7.5-5.7 0-9.5 1.6-15.7 6.7-2.4 1.9-4.3 3.2-4.3 3 0-.3.7-2.1 1.5-4.1.9-2 1.3-4.1 1-4.6-.4-.6-3.7-1-7.6-1-6.9 0-6.9 0-6.9 2.8 0 3.1-8.1 17.8-14.9 27.2-5.8 8-17.3 18.7-22.5 21.1-11.4 5.2-15.8-1.8-9.3-15 2-4.1 2.7-4.6 7.7-5.8 11.9-2.9 24.9-11.3 28.5-18.4 2.1-4 1.9-9.2-.5-11.4-1.5-1.4-3-1.7-6.7-1.2-17.2 2-35.5 17.7-42.7 36.6-2.1 5.4-3.9 8.1-8.4 12.4-6.4 6.1-9.5 7.5-11.8 5.6-2.8-2.3-.9-7 9.2-23.5C500.2 71 505.5 60.6 504.5 59c-.8-1.2-8.5-1.3-11.7-.1-1.6.6-2.8 2.2-3.6 4.8-2 6.7-19.5 35.4-25 41.1-5.1 5.1-8.7 6.6-9.8 3.8-.6-1.7 3-9.1 9.6-19.6 12.6-20.1 14.1-27.7 6.1-31.9-4.6-2.5-13.9.9-20 7.3-1.9 2-3.9 3.6-4.3 3.6s-.8-1.6-.8-3.5c0-4.6-2.9-7.5-7.5-7.5-4.2 0-8.4 2-14.2 6.7l-4.2 3.5.9-3.2c1.4-5 .5-6-6-6-6.3 0-8.2 1.3-9.4 6.3-.6 2.7-17.1 33-24.7 45.4-2.2 3.5-3.9 6.6-3.9 6.8 0 .3 3.1.5 6.8.5h6.8l8.2-13.8c11.1-18.8 19.6-30.5 25.6-35.3 5.1-4.1 8.8-4.8 9.4-1.8.2.9-5.8 12.5-13.3 25.8-7.4 13.2-13.5 24.3-13.5 24.6s2.8.5 6.2.3l6.2-.3 13-20.8c13.2-20.9 20.3-29.9 25.2-31.7 7-2.7 5.7 3-5 21-7.7 12.9-11.6 21.6-11.6 25.8 0 2 5.5 7.2 7.7 7.2 3.9 0 9.5-2.2 13.8-5.5 2.5-1.9 4.7-3.5 5-3.5s.5 1.3.5 2.8c0 1.7 1 3.8 2.5 5.2 2.1 2 3.1 2.2 7.4 1.7 6.3-.7 10.2-2.8 16.2-8.4l4.7-4.4 1.1 3.4c.7 1.9 2.3 4.5 3.7 5.8 2.1 2 3.6 2.4 8.7 2.4 7.1 0 11.8-2.3 20-9.5 2.6-2.3 4.7-3.9 4.7-3.6s-1.3 2.7-3 5.3c-4.3 6.8-4.1 7.3 3.3 7.3h6.3l11.2-17.3c12.5-19.4 19.9-28.6 26.3-32.8 5.1-3.5 8.5-3.5 8.2-.1-.2 1.3-4.4 8.6-9.3 16.3-5 7.7-10 15.9-11.2 18.2-2.7 5.4-2.9 11.8-.4 14.6 4.4 4.8 16.5 1.1 25.6-8l4.8-4.8.6 3.8c1.3 8.3 8.3 12.4 17.3 10.2 18.5-4.6 39.3-28 39.3-44.3 0-14-8.6-18.8-20-11.1-5.5 3.7-5.5 3.7-3.6.8 5.6-8.5 23.6-41 24.1-43.6.8-3.7 0-4.6-4-4.2zM542.6 62.5c.3.8-.7 3.7-2.2 6.5-3.8 7-16.5 17-21.5 17-1.7 0 9-14.6 14.6-19.9 5.5-5.2 8.1-6.2 9.1-3.6zm101 3c1.9 7.8-15.7 39.6-25.6 46.3-2.2 1.4-4.6 2.2-6.5 2-2.6-.3-3-.7-3.3-3.6-.8-8.1 8.8-27.5 19.7-39.5 7-7.8 14.4-10.2 15.7-5.2zM821 16c-1.1 1.1-2 2.7-2 3.5 0 2.1-5.3 12.5-9.7 19.2l-3.6 5.3h-5.8c-5.6 0-5.9.1-5.9 2.4 0 2.2.5 2.5 4.4 2.8l4.4.3-11 18c-6 9.9-13 22-15.4 27-4.7 9.9-7.3 13-12.1 15.1-4.2 1.8-6.3 1.8-6.3-.1 0-2.6 4.7-11 12.7-22.8C779.3 74 781 70.5 781 65.5c0-5.2-2.8-7.5-9-7.5-5.7 0-9.5 1.6-15.7 6.7-2.4 1.9-4.3 3.2-4.3 3 0-.3.7-2.1 1.5-4.1.9-2 1.3-4.1 1-4.6-.4-.6-3.7-1-7.6-1-6.9 0-6.9 0-6.9 2.8 0 3.1-8.1 17.8-14.9 27.2-5.8 8-17.3 18.7-22.5 21.1-11.4 5.2-15.8-1.8-9.3-15 2-4.1 2.7-4.6 7.7-5.8 11.9-2.9 24.9-11.3 28.5-18.4 2.1-4 1.9-9.2-.5-11.4-1.5-1.4-3-1.7-6.7-1.2-17.2 2-35.5 17.7-42.7 36.6-2.1 5.4-3.9 8.1-8.4 12.4-6.4 6.1-9.5 7.5-11.8 5.6-2.8-2.3-.9-7 9.2-23.5C679.2 71 684.5 60.6 683.5 59c-.8-1.2-8.5-1.3-11.7-.1-1.6.6-2.8 2.3-3.6 4.9-.7 2.2-4.9 10-9.3 17.3-10.4 17-12.9 22.7-12.9 28.8 0 3.8.5 5.2 2.5 7.1 2.1 2 3.1 2.2 7.4 1.7 6.3-.7 10.2-2.8 16.2-8.4l4.7-4.4 1.1 3.4c.7 1.9 2.3 4.5 3.7 5.8 2.1 2 3.6 2.4 8.7 2.4 7.1 0 11.8-2.3 20-9.5 2.6-2.3 4.7-3.9 4.7-3.6s-1.3 2.7-3 5.3c-4.3 6.8-4.1 7.3 3.3 7.3h6.3l11.2-17.3c12.5-19.4 19.9-28.6 26.3-32.8 5.1-3.5 8.5-3.5 8.2-.1-.2 1.3-4.4 8.6-9.3 16.3-11.4 17.8-13.3 21.4-13.4 26.5-.2 10.4 11 11.4 23.4 2l3.5-2.7.8 3c2.1 8.2 12.3 8.2 22.8 0 4.4-3.5 5.6-3.7 3.5-.7-3.1 4.4-2.2 5.8 3.7 5.8 3.9 0 5.8-.5 6.9-1.8.9-.9 5.8-8.7 10.8-17.2 13.2-22 18-28.1 26-32.9 5.2-3.1 7-2.8 7 1.2 0 2.5-2.2 6.8-8.2 16.3-9.8 15.5-12.8 21.7-12.8 26.5 0 4.4 3.3 7.9 7.6 7.9 4.5 0 12.6-4.5 18.6-10.3l5.4-5.2-.4 5.2c-.5 6.3 1.3 9.8 5.7 10.8s9.5-1.7 17.1-9.1l6.9-6.6-.2 5.5c-.2 4.2.3 6 1.7 7.6 2.8 3.1 8.3 2.8 13.2-.7l3.9-2.8 2 3c1.1 1.6 3.1 3.3 4.5 3.6 3.8 1 11.1-1.5 15.8-5.5 2.3-2 4.2-3.4 4.2-3.1 0 1.2-10.4 19.3-13.5 23.6-4.7 6.4-14.3 15.4-19.3 17.9-4.7 2.4-10.9 2.7-13.7.8-1.6-1.2-1.6-1.8-.7-4.7 1.6-4.4 1.5-5.6-.4-7.4-3.8-3.8-10.4.2-10.4 6.3 0 11 18.9 13.3 36.9 4.5 11.2-5.5 20.6-15.4 29.7-31.4 3.9-6.9 10.6-18.4 14.9-25.5 16.8-28.2 19.1-32.6 18-34.5-.4-.6-3.5-1-7.1-1-5.3 0-6.6.3-7 1.7-.8 2.9-12.5 25.4-16.1 31.2-6.9 10.8-18.9 21.2-22.8 19.7-2.8-1 1.4-11 11-26.7 7.3-11.8 12.7-22.8 12.1-24.5-.6-1.5-4.4-1.8-9.5-.8-2.7.6-3.6 1.5-5.5 5.8-1.3 2.8-5.8 10.6-10 17.4-7.7 12.2-12.6 21.5-12.6 23.9 0 1.7-4.6 4.6-6 3.8-3.2-2 .2-11 10.4-27.8 7.7-12.8 11.5-20.1 11.6-22.5 0-.8-1.4-1.2-4.2-1.1-9.3.3-9.7.6-13.8 10.2-6.6 15.4-24.1 39.3-30.4 41.7-2.9 1-4.6.2-4.6-2.4 0-1.2 3.9-8.7 8.6-16.7C900 63.4 901.8 58 894.5 58c-6.7 0-9.5 1.1-10 3.9-2.4 12.1-24.9 42.1-34.6 46.1-7.4 3.1-5.5-3.2 6.1-20.5 8.5-12.6 10-15.9 10-21.8 0-9.6-10.3-11.3-20.9-3.6-2.4 1.7-4.4 2.9-4.6 2.7s4.2-7.7 9.7-16.8c13.2-21.9 16.4-28.5 14.7-30.6-1-1.2-2.4-1.5-6.1-1-6.7.9-7.5 1.4-8.3 4.4-.3 1.5-2.3 5.6-4.5 9.2-2.1 3.6-7.5 13-12 21-28.3 50.1-35.9 60.5-43.8 59.8-5-.4-5.2-2.6-1.2-12.1 3.3-8.1 16.2-30.6 24.2-42.5l4.9-7.2h5.4c5.2 0 5.5-.1 5.5-2.5 0-2.3-.4-2.5-4-2.5-2.2 0-4-.2-4-.6 0-.3 1.8-3.2 4-6.4 5-7.4 11-18.9 11-21.3 0-2.7-12.2-2.5-15 .3zm-99.4 46.5c.3.8-.7 3.7-2.2 6.5-3.8 7-16.5 17-21.5 17-1.7 0 9-14.6 14.6-19.9 5.5-5.2 8.1-6.2 9.1-3.6zM271.5 16.5c-.5.2-2.2.6-3.7.9-1.6.4-2.8 1.2-2.8 1.9 0 1.7-2.4 6.2-12.9 24.7-18.8 33.1-33.6 57.7-36.5 60.9-4.7 5.1-12.6 8-12.6 4.6 0-2.6 4.7-11 12.7-22.8C224.3 74 226 70.5 226 65.5c0-5.2-2.8-7.5-9-7.5-5.7 0-9.5 1.6-15.7 6.7-2.4 1.9-4.3 3.2-4.3 3 0-.3.7-2.1 1.5-4.1.9-2 1.3-4.1 1-4.6-.4-.6-3.7-1-7.6-1-6.9 0-6.9 0-6.9 2.8 0 5.5-20.8 38.1-29.4 46-4.8 4.4-7 5.2-7.9 2.8-1-2.5 1-7.5 7.2-18 8.4-14.3 18.1-31.8 18.1-32.8 0-.4-2.9-.8-6.5-.8s-6.5.4-6.5.8c0 .5-.6 1.6-1.3 2.6-1.3 1.8-1.5 1.7-4.1-.9-2.4-2.4-3.4-2.7-7-2.3-13.6 1.6-31.1 16.8-39.7 34.5-5.8 11.8-16.5 21-18.5 15.9-.6-1.7 3-9.1 9.6-19.6 12.6-20.1 14.1-27.7 6.1-31.9-4.6-2.5-13.9.9-20 7.3-1.9 2-3.9 3.6-4.3 3.6s-.8-1.6-.8-3.5c0-4.6-2.9-7.5-7.5-7.5-4.2 0-8.4 2-14.2 6.7l-4.2 3.5.9-3.2c1.4-5 .5-6-6-6-6.3 0-8.2 1.3-9.4 6.3-.6 2.7-17.1 33-24.7 45.4-2.2 3.5-3.9 6.6-3.9 6.8 0 .3 3.1.5 6.8.5h6.8l8.2-13.8c11.1-18.8 19.6-30.5 25.6-35.3 5.1-4.1 8.8-4.8 9.4-1.8.2.9-5.8 12.5-13.3 25.8-7.4 13.2-13.5 24.3-13.5 24.6s2.8.5 6.2.3l6.2-.3 13-20.8C79.6 74.8 86.7 65.8 91.6 64c7-2.7 5.7 3-5 21C78.9 97.9 75 106.6 75 110.8c0 .7 1.4 2.7 3 4.4 2.8 2.7 3.5 3 7.1 2.4 5.4-.9 9.2-2.9 14.4-7.7l4.3-3.9.7 3.6c.3 2.1 2 5 3.6 6.7 2.5 2.5 3.6 2.9 6.4 2.4 3.8-.6 9.8-4.5 16.4-10.6 2.4-2.3 4.5-4.1 4.7-4.1s.4 2.2.4 5c0 6.2 2.7 9.6 6.8 8.5 3.5-.9 8.2-3.1 11.1-5.2 2.4-1.7 2.4-1.7 1.3.4-2.1 3.8-1.5 4.3 5.1 4.3h6.3l11.2-17.3c12.5-19.4 19.9-28.6 26.3-32.8 5.1-3.5 8.5-3.5 8.2-.1-.2 1.3-4.4 8.6-9.3 16.3-11.4 17.8-13.3 21.4-13.4 26.5-.2 8.3 7.1 10.9 16.7 6 4.4-2.2 4.7-2.2 4.7-.5 0 1.6.8 1.9 5.3 1.9 3.9 0 5.8-.5 6.9-1.8.9-.9 5.8-8.7 10.8-17.2 13.2-22 18-28.1 26-32.9 5.2-3.1 7-2.8 7 1.2 0 2.5-2.2 6.8-8.2 16.3-13.4 21.3-15.4 27.6-10.3 32.4 4.2 3.9 12 1.6 22.4-6.7l3.5-2.8-2.7 4c-4.2 6.2-3.7 7.5 2.6 7.5 3.9 0 5.8-.5 6.9-1.8.9-.9 5.8-8.7 10.8-17.2 13.2-22 18-28.1 26-32.9 5.2-3.1 7-2.8 7 1.2 0 2.5-2.2 6.8-8.2 16.3-13.3 21.1-15.4 27.6-10.5 32.2 4.5 4.3 12 2 22.5-6.7 5.6-4.7 6.2-5 6.2-2.9 0 3.7 3.4 8.3 7.6 10.3 14.4 7 36.7-6.2 47.5-28 4-8 4.4-9.5 4.4-16.1 0-6.3-.3-7.6-2.4-9.8-8.4-8.9-26.6-4-42.2 11.5-6.3 6.2-8.5 9.2-12.2 17-3.4 7.1-5.7 10.3-9.1 13.1-5.7 4.8-9.3 6.5-10.7 5.1-1.6-1.6 1.6-8.1 10.1-20.8 8.5-12.6 10-15.9 10-21.8 0-9.6-10.3-11.3-20.9-3.6-2.4 1.7-4.4 2.9-4.6 2.7s4.2-7.7 9.7-16.8c13.2-21.9 16.4-28.5 14.7-30.6-2-2.4-13.9-.7-13.9 2S293.2 74.5 284 88c-5 7.3-16 18.3-20.1 20-7.4 3.1-5.6-3.1 6.1-20.5 8.5-12.6 10-15.9 10-21.8 0-9.6-10.3-11.3-20.9-3.6-2.4 1.7-4.4 2.9-4.6 2.7s4.2-7.7 9.7-16.8c13-21.5 16.4-28.5 14.8-30.5-1.1-1.4-4.9-1.9-7.5-1zM151.8 62.2c3.2 3.2-.1 12.6-10.1 28.1-8.9 13.8-16.1 20.7-21.6 20.7-2.7 0-4.4-3.4-3.5-7.3 2.3-11.1 21.5-37.5 29.9-41.3 3.7-1.7 3.8-1.7 5.3-.2zm232 0c3.5 3.5-1 17.8-9.8 31.1-10.1 15.4-20.3 22.2-25.5 17-6.8-6.7 12.9-39 29-47.6 3.7-2 4.7-2.1 6.3-.5z"/><path d="M505.6 33c-6.8 8.1.3 14.8 7.8 7.3 2.1-2.1 2.6-3.5 2.4-6.2-.3-3.3-.6-3.6-3.9-3.9-3-.3-4.1.2-6.3 2.8zM684.6 33c-6.8 8.1.3 14.8 7.8 7.3 2.1-2.1 2.6-3.5 2.4-6.2-.3-3.3-.6-3.6-3.9-3.9-3-.3-4.1.2-6.3 2.8z"/></svg> </a></div></div></header><main><div class="grid grid-cols-1 md:grid-cols-7 items-start gap-6 container mx-auto px-6"><div class=md:col-span-5><div class="bg-white p-8 shadow-lg dark:bg-slate-800"><h1 class="mb-4 text-3xl leading-relaxed font-bold text-slate-900 uppercase dark:text-slate-100 after:block after:h-px after:w-8 after:mb-4 after:bg-slate-900 after:shadow-heading dark:after:bg-slate-100 dark:after:shadow-heading-dark">Javascript: Promise</h1><div class="flex flex-wrap gap-x-4 mb-4 py-2 text-sm leading-relaxed text-slate-400"><div><svg class="inline size-4" viewbox="0 2 24 24" fill=none stroke=currentColor stroke-width=2 xmlns=http://www.w3.org/2000/svg><path d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" stroke-linecap=round stroke-linejoin=round /></svg><a href=https://manhhomienbienthuy.github.io/category/lap-trinh.html> Lập trình </a></div><div><svg class="inline size-4" viewbox="0 2 24 24" fill=none stroke=currentColor stroke-width=2 xmlns=http://www.w3.org/2000/svg><path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap=round stroke-linejoin=round /></svg><a href=https://manhhomienbienthuy.github.io/2018> 2018-06-20 </a></div><div><svg class="inline size-4" viewbox="0 2 24 24" fill=none stroke=currentColor stroke-width=2 xmlns=http://www.w3.org/2000/svg><path d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap=round stroke-linejoin=round /></svg><a href=https://manhhomienbienthuy.github.io/pages/gioi-thieu.html> manhhomienbienthuy </a></div><div><svg class="inline size-4" viewbox="0 2 24 24" fill=none stroke=currentColor stroke-width=2 xmlns=http://www.w3.org/2000/svg><path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" stroke-linecap=round stroke-linejoin=round /></svg> 2025-06-05 09:22:54 (UTC)</div></div><figure class=mb-10><img alt="Javascript: Promise" class="w-full mb-4" decoding=async height=270 loading=lazy src=https://cdn.pixabay.com/photo/2014/04/21/20/09/pinky-swear-329329_1280.jpg width=360><figcaption class="pb-2 text-sm text-slate-400 border-b border-slate-100 dark:border-slate-700">Ảnh của <a class="text-crimson hover:text-slate-400" rel="noopener noreferrer" href=https://pixabay.com/users/cherylholt-209609/ target=_blank>Cheryl Holt</a> từ <a class="text-crimson hover:text-slate-400" rel="noopener noreferrer" href=https://pixabay.com/photos/pinky-swear-friendship-gesture-329329/ target=_blank>Pixabay</a></figcaption></figure><div class="md:text-lg leading-loose md:leading-loose text-justify"><p class=my-4>JavaScript là một ngôn ngữ lập trình phía client, giúp chúng ta có những ứng dụng web đẹp hơn, thao tác dễ hơn, hiệu ứng cool hơn. Tuy nhiên, cách thức hoạt động của JavaScript hơi đặc thù một chút. Rất nhiều hoạt động của nó đều ở dạng bất đồng bộ (asynchronous).<p class=my-4>Vì vậy, việc kiểm soát code để nó có thể hoạt động trơn tru cũng không phải là việc đơn giản. Trong bài viết này, chúng ta sẽ tìm hiểu những phương thức mới được giới thiệu từ ECMAScript 2015 trở đi, giúp chúng ta code JavaScript bất đồng bộ được dễ dàng hơn.<div class="p-2 text-xs leading-relaxed bg-slate-100 whitespace-nowrap overflow-auto dark:bg-slate-900"><span class="font-semibold text-sm text-slate-900 mb-4 dark:text-slate-100">Mục lục</span><ul><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#cach-truyen-thong-dung-callback>Cách truyền thống: dùng callback</a><ul class=ml-5><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#callback-long-nhau>Callback lồng nhau</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#xu-ly-khi-gap-loi>Xử lý khi gặp lỗi</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#callback-hell>Callback hell</a></ul><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#promise>Promise</a><ul class=ml-5><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#tao-promise>Tạo promise</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#su-dung-then-va-catch>Sử dụng then và catch</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#co-che-trycatch-ngam>Cơ chế try...catch ngầm</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#timing>Timing</a></ul><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#promise-chain>Promise chain</a><ul class=ml-5><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#chain-on-gian-voi-gia-tri-uoc-tra-ve>Chain đơn giản với giá trị được trả về</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#return-mot-promise>Return một promise</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#xu-ly-khi-gap-loi_1>Xử lý khi gặp lỗi</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#chain-tiep-theo-catch>Chain tiếp theo catch</a></ul><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#promise-api>Promise API</a><ul class=ml-5><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#resolve>resolve</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#reject>reject</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#all>all</a><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#race>race</a></ul><li><a class="text-crimson hover:text-slate-600 dark:hover:text-slate-300" href=#ket-luan>Kết luận</a></ul></div><h2 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-3xl text-slate-900 dark:text-slate-100" id=cach-truyen-thong-dung-callback><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#cach-truyen-thong-dung-callback> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Cách truyền thống: dùng callback</h2><p class=my-4>Callback là tên mà chúng ta dùng để gọi các hàm JavaScript trong một trường hợp đặc biệt. Rất khó để định nghĩa chúng nhưng có thể rất dễ hiểu thông qua ví dụ dưới đây. Callback chỉ là tên được cộng động dùng, nó không có gì đặc biệt trong ngôn ngữ này cả.<p class=my-4>Thuật ngữ bất đồng bộ (asynchronous, hoặc gọi ngắn là async) có thể hiểu rằng “sẽ mất một chút thời gian”, “sẽ hoàn thành trong tương lai, không phải bây giờ”. Callback là phương án được sử dụng phổ biến trong những hoạt động bất đồng bộ này.<p class=my-4>Hoạt động bất đồng bộ của JavaScript diễn ra rất thường xuyên. Là một lập trình viên web, chắc hẳn bạn đã rất quen thuộc với những truy vấn kiểu ajax. Chúng ta có thể xem xét một ví dụ thực tế như sau:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>function</span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>script</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>'script'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>script</span><span class=p>.</span><span class=nx>src</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>src</span><span class=p>;</span>
<span class=w>    </span><span class=nb>document</span><span class=p>.</span><span class=nx>head</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=nx>script</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p class=my-4>Mục đích của hàm trên là để load một file JavaScript bằng JavaScript. Sau khi chạy hàm này, nó sẽ chèn thêm một thẻ <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">&lt;script
src="${src}">&lt;/script></code> vào trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">head</code>, sau đó trình duyệt sẽ tải file này về và thực thi.<p class=my-4>Cách sử dụng nó rất đơn giản:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=c1>// loads and executes the script</span>
<span class=nx>loadScript</span><span class=p>(</span><span class=s1>'/my_script.js'</span><span class=p>);</span>
</code></pre></div><p class=my-4>Hàm này hoạt động một cách bất đồng bộ, bởi vì việc tải file script sẽ mất một chút thời gian. Việc gọi hàm sẽ bất đầu việc load script, việc load này sẽ được trình duyệt thực hiện “ngầm” bởi một tiến trình khác. Những code phía dưới hàm này sẽ tiếp tục được thực thi mà không cần đợi script được load. Thâm chí, nó có thể kết thúc trước cả việc script được load xong.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'/my_script.js'</span><span class=p>);</span>
<span class=c1>// Code dưới này sẽ được thực thi ngay là không chờ script load xong</span>
</code></pre></div><p class=my-4>Việc hoạt động bất đồng bộ này không phải là vấn đề, chúng ta hoàn toàn không cần quan tâm. Tuy nhiên, có một vài trường hợp, khi load script mới, nó định nghĩa một số hàm và biến, và chúng ta cần sử dụng lại những thứ này. Điều này thường gặp khi chúng ta sử dụng các thư viện, như jQuery chẳng hạn:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>);</span>
<span class=nx>$</span><span class=p>(</span><span class=s2>"#test"</span><span class=p>).</span><span class=nx>hide</span><span class=p>();</span>
</code></pre></div><p class=my-4>Rất tự nhiên, trình duyệt sẽ cần thời gian để tải thư viện jQuery về. Tuy nhiên, nó lại không chờ cho script được tải về mà sẽ ngay lập tức thực hiện lệnh tiếp theo.<p class=my-4>Vì vậy, những code tiếp theo sẽ không thực thi được mà chúng ta sẽ gặp lỗi:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>Uncaught</span><span class=w> </span><span class=ne>ReferenceError</span><span class=o>:</span><span class=w> </span><span class=nx>$</span><span class=w> </span><span class=nx>is</span><span class=w> </span><span class=nx>not</span><span class=w> </span><span class=nx>defined</span>
</code></pre></div><p class=my-4>Với cách làm như trên, chúng ta chưa có cách nào theo dõi trạng thái của việc load script. Nhưng nếu chúng ta muốn sử dụng những hàm và biến được định nghĩa trong script, chúng ta cần sử dụng một phương thức khác. Truyền callback là một cách phổ thông nhất.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>function</span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=nx>src</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>script</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>'script'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>script</span><span class=p>.</span><span class=nx>src</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>src</span><span class=p>;</span>
<span class=w>    </span><span class=nx>script</span><span class=p>.</span><span class=nx>onload</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>callback</span><span class=p>;</span>
<span class=w>    </span><span class=nb>document</span><span class=p>.</span><span class=nx>head</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=nx>script</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p class=my-4>Bây giờ, muốn sử dụng những gì được định nghĩa trong script, chúng ta có thể cho vào callback:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>,</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=c1>// callback được gọi sau khi script load xong</span>
<span class=w>  </span><span class=nx>$</span><span class=p>(</span><span class=s2>"#test"</span><span class=p>).</span><span class=nx>hide</span><span class=p>();</span>
<span class=w>  </span><span class=p>...</span>
<span class=p>});</span>
</code></pre></div><p class=my-4>Ý tưởng của việc này rất đơn giản, chúng ta truyền một hàm làm tham số của hàm khác, hàm này gọi là callback. Và hàm đó sẽ được gọi khi sau khi thực hiện xong một số đoạn code cần thiết. Đó cũng là phương thức xưa nay vẫn thường được sử dụng. Bất cứ một hàm nào hoạt động bất đồng bộ cũng cần cung cấp một tham số dành riêng cho việc truyền callback.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=callback-long-nhau><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#callback-long-nhau> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Callback lồng nhau</h3><p class=my-4>Việc sử dụng callback như trên rất tốt. Nhưng mọi việc sẽ phức tạp hơn khi chúng ta cần load nhiều hơn một script.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>,</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'jQuery loaded'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js'</span><span class=p>,</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'lodash 2 loaded'</span><span class=p>);</span>
<span class=w>        </span><span class=p>...</span>
<span class=w>    </span><span class=p>})</span>
<span class=p>})</span>
</code></pre></div><p class=my-4>Với cách gọi callback lồng nhau như trên, sau khi script thứ nhất load xong, callback sẽ gọi việc load script thứ hai.<p class=my-4>Code như trên vẫn còn trông rất đẹp, nhưng nếu chúng ta có nhiều script hơn nữa thì sao:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script1.js'</span><span class=p>,</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script2.js'</span><span class=p>,</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script3.js'</span><span class=p>,</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script4.js'</span><span class=p>,</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=p>...</span>
<span class=w>            </span><span class=p>})</span>
<span class=w>        </span><span class=p>})</span>
<span class=w>    </span><span class=p>})</span>
<span class=p>})</span>
</code></pre></div><p class=my-4>Việc sử dụng callback lồng nhau vẫn ổn nếu chúng ta lồng nhau ít cấp. Nhưng khi mức độ lồng nhau tăng lên, rõ ràng là không thể dùng cách này được. Mọi việc sẽ còn phức tạp hơn nữa khi các hoạt động bất đồng bộ này không phải lúc nào cũng thành công.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=xu-ly-khi-gap-loi><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#xu-ly-khi-gap-loi> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Xử lý khi gặp lỗi</h3><p class=my-4>Trong những ví dụ ở trên, chúng ta hoàn toàn không quan tâm đến trường hợp bị lỗi. Chúng ta nên nâng cấp code một chút để nó có thể xử lý thêm trường hợp này<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>function</span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=nx>src</span><span class=p>,</span><span class=w> </span><span class=nx>callback</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>script</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>'script'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>script</span><span class=p>.</span><span class=nx>src</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>src</span><span class=p>;</span>
<span class=w>    </span><span class=nx>script</span><span class=p>.</span><span class=nx>onload</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>callback</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>);</span>
<span class=w>    </span><span class=nx>script</span><span class=p>.</span><span class=nx>onerror</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>callback</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>'script not loaded'</span><span class=p>));</span>
<span class=w>    </span><span class=nb>document</span><span class=p>.</span><span class=nx>head</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=nx>script</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p class=my-4>Việc sử dụng rất đơn giản, hàm được truyền làm callback cần có hai tham số, tham số thứ nhất là lỗi (nếu không có lỗi thì truyền vào <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">null</code>) và tham số thứ hai là script được load.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'my_script.js'</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Có lỗi xảy ra khi load script</span>

<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Script đã load xong</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>});</span>
</code></pre></div><p class=my-4>Việc định nghĩa callback như trên là theo phong cách <a class="text-crimson border-b border-dotted border-crimson hover:text-slate-600 hover:border-slate-600 dark:hover:text-slate-300 dark:hover:border-slate-300" rel="noopener noreferrer" href=https://stackoverflow.com/a/40512067 target=_blank>error-first callback</a>. Convention rất đơn giản: tham số đầu tiên dùng để truyền lỗi khi nó xảy ra. Những tham số tiếp theo dùng để truyền kết quả cho trường hợp bình thường (khi đó, tham số đầu tiên sẽ là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">null</code>). Bằng cách này, chúng ta chỉ cần định nghĩa một callback cho cả trường hợp có lỗi và không.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=callback-hell><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#callback-hell> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Callback hell</h3><p class=my-4>Những trường hợp ở trên, chúng ta đã xem xét cách sử dụng callback cho các hoạt động bất đồng bộ. Và trong trường hợp cần thiết, chúng ta cần phải sử dụng callback trong callback, thậm chí lồng nhau vài lớp. Nhưng càng lồng nhau nhiều, nguy cơ mất kiểm soát code sẽ càng tăng lên.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script1.js'</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script2.js'</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script3.js'</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>                    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>                        </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script4'</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>                            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                                </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>                            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>                                </span><span class=c1>// Code sau khi tất cả các hoạt động bất đồng</span>
<span class=w>                                </span><span class=c1>// bộ hoàn thành.</span>
<span class=w>                            </span><span class=p>}</span>
<span class=w>                        </span><span class=p>})</span>
<span class=w>                    </span><span class=p>}</span>
<span class=w>                </span><span class=p>})</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>})</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>})</span>
</code></pre></div><p class=my-4>Vâng, phải nói là trông code rất đẹp. Mọi việc rất đơn giản theo flow như sau:<ul class="list-[revert] ml-5"><li>Load <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">script1.js</code>, nếu không có lỗi thì tiếp tục.<li>Load <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">script2.js</code>, nếu không có lỗi thì tiếp tục.<li>Load <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">script3.js</code>, nếu không có lỗi thì tiếp tục.<li>Load <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">script4.js</code>, nếu không có lỗi thì bắt đầu xử lý logic chúng ta cần.</ul><p class=my-4>Với cách làm như thế này thì code có thể tiếp tục mở rộng thêm nữa mà không gặp vấn đề gì. Nhưng khi mọi thứ trở nên phức tạp hơn, việc lồng nhau mức độ cao hơn, đặc biệt, khi chúng ta có những code với vòng lặp, các câu lệnh điều kiện, rẽ nhánh, v.v… việc kiểm soát code sẽ trở nên cực kỳ khó khăn.<p class=my-4>Vấn đề này trong lập trình nói chung được gọi là <a class="text-crimson border-b border-dotted border-crimson hover:text-slate-600 hover:border-slate-600 dark:hover:text-slate-300 dark:hover:border-slate-300" rel="noopener noreferrer" href=http://calculist.org/blog/2011/12/14/why-coroutines-wont-work-on-the-web/ target=_blank>pyramid of doom</a> (do code trông như xây kim tự tháp). Riêng trong JavaScript nó còn được gọi với tên gọi là khác <a class="text-crimson border-b border-dotted border-crimson hover:text-slate-600 hover:border-slate-600 dark:hover:text-slate-300 dark:hover:border-slate-300" rel="noopener noreferrer" href=http://thecodebarbarian.com/2015/03/20/callback-hell-is-a-myth target=_blank>callback hell</a>.<p class=my-4>Nguyên nhân của callback hell là khi chúng ta cố gắng viết code JavaScript theo kiểu tuần tự như những ngôn ngữ khác. Nhưng vì đặc thù của hoạt động bất đồng bộ, nên việc tuần tự này không thể thực hiện được. Callback hell thường xảy ra ở những lập trình viên còn ít kinh nghiệm, tuy nhiên, kể cả người đã đi làm nhiều năm vẫn có thể gặp phải, bởi cấu trúc code lồng nhau thật quá phức tạp.<p class=my-4>Ví dụ với code ở trên thì mọi thứ vẫn chạy tốt, nhưng chỉ cần đóng mở ngoặc sai một ly thôi là đi luôn một dặm. <a class="text-crimson border-b border-dotted border-crimson hover:text-slate-600 hover:border-slate-600 dark:hover:text-slate-300 dark:hover:border-slate-300" rel="noopener noreferrer" href=http://callbackhell.com/ target=_blank>Trang web này</a> có đưa ra một số phương án để phòng tránh callback hell cũng khá hay, có thể áp dụng được. Tuy nhiên, trong bài viết này, chúng ta sẽ tìm hiểu một phương án còn hay hơn nữa.<p class=my-4>Một cách đơn giản để trông code có vẻ đơn giản hơn, tránh code trông như kim tự tháp kia là định nghĩa các hàm và gọi chúng như sau:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script1.js'</span><span class=p>,</span><span class=w> </span><span class=nx>callbackAfterScript1</span><span class=p>);</span>

<span class=nx>callbackAfterScript1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script2.js'</span><span class=p>,</span><span class=w> </span><span class=nx>callbackAfterScript2</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=nx>callbackAfterScript2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script3.js'</span><span class=p>,</span><span class=w> </span><span class=nx>callbackAfterScript3</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=nx>callbackAfterScript3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script4.js'</span><span class=p>,</span><span class=w> </span><span class=nx>callbackAfterScript4</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=nx>callbackAfterScript4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>,</span><span class=w> </span><span class=nx>script</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>handleError</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Code sau khi tất cả các hoạt động bất đồng</span>
<span class=w>        </span><span class=c1>// bộ hoàn thành.</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p class=my-4>Bằng cách làm như trên, dù code không thay đổi về bản chất, nhưng kim tự tháp của chúng ta đã thấp đi đáng kể, bằng cách đó, callback hell sẽ khó xảy ra hơn. Mặc dù vậy, code này lại trở nên khó đọc hơn, để hiểu được hoạt động của nó, chúng ta phải do từ hàm này đến hàm khác. Nếu mức độ lồng nhau nhiều, thì việc làm này cũng tốn không ít thời gian.<p class=my-4>May mắn cho chúng ta, từ khi ECMAScript 2015 (ES 6) ra đời, chúng ta đã có phương án tốt hơn rất nhiều để giải quyết.<h2 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-3xl text-slate-900 dark:text-slate-100" id=promise><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#promise> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Promise</h2><p class=my-4><a class="text-crimson border-b border-dotted border-crimson hover:text-slate-600 hover:border-slate-600 dark:hover:text-slate-300 dark:hover:border-slate-300" rel="noopener noreferrer" href=https://www.ecma-international.org/ecma-262/6.0/#sec-promise-constructor target=_blank>Promise</a> được giới thiệu kể từ ECMAScript 2015. Đây là một điểm sáng giúp chúng ta giải quyết các logic bất đồng bộ một cách tốt hơn.<p class=my-4>Promise (lời hứa) có thể hiểu thế này: bạn hứa với mọi người sẽ làm việc XYZ và sẽ cho họ xem kết quả khi làm xong, nhưng bạn không biết chính xác khi nào thì sẽ xong. Họ cứ làm việc của họ trong lúc chờ đợi, khi công việc hoàn thành, bạn báo cho họ kết quả. Nếu chẳng may đại sự bất thành, bạn cũng thông báo cho họ không phải chờ nữa.<p class=my-4>Như vậy, lời hứa được đảm bảo, ai nấy đều vui vẻ cả. Promise cũng được thiết kế với ý tưởng tương tự như vậy.<p class=my-4>Một vài hoạt động bất đồng bộ, nó cần thời gian để hoàn thành, như ví dụ, đó là load một script khác. Rất nhiều code khác đang chờ công việc đó hoàn thành, promise là lời hứa mà loadScript đưa cho họ. Khi nào loadScript hoàn thành, những ai đang chờ sẽ được thông báo, kể cả load thất bại thì việc thất bại đó cũng được thông báo luôn.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=tao-promise><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#tao-promise> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Tạo promise</h3><p class=my-4>Promise được tạo ra như sau:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>let</span><span class=w> </span><span class=nx>promise</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// code thực hiện logic</span>
<span class=p>});</span>
</code></pre></div><p class=my-4>Hàm được truyền vào để khởi tạo <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise</code> được gọi là “executor”. Hàm này sẽ được thực thi khi promise được tạo ra. Khi executor kết thúc, nó phải gọi một trong số hai hàm <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code>.<ul class="list-[revert] ml-5"><li>Gọi <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code> khi code chạy thành công, công việc kết thúc mà không có lỗi gì. Khi đó, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">state</code> của đối tượng promise sẽ là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">fulfilled</code> (trạng thái khởi tạo là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">pending</code>), đồng thời <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code> của đối tượng promise sẽ là giá trị của tham số được truyền cho <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code>.<li>Gọi <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code> nếu có lỗi xảy ra, khi đó <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">state</code> của đối tượng promise sẽ là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">rejected</code>, đồng thời <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code> cũng sẽ là tham số được truyền vào cho <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code>.</ul><p class=my-4>Quay lại trường hợp loadScript ở trên, chúng ta sẽ chuyển sang dùng promise như sau, không cần phải truyền callback vào nữa.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>function</span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=nx>src</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>const</span><span class=w> </span><span class=nx>script</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>'script'</span><span class=p>);</span>
<span class=w>        </span><span class=nx>script</span><span class=p>.</span><span class=nx>src</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>src</span><span class=p>;</span>
<span class=w>        </span><span class=nx>script</span><span class=p>.</span><span class=nx>onload</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>script</span><span class=p>);</span>
<span class=w>        </span><span class=nx>script</span><span class=p>.</span><span class=nx>onerror</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>'script not loaded'</span><span class=p>));</span>
<span class=w>        </span><span class=nb>document</span><span class=p>.</span><span class=nx>head</span><span class=p>.</span><span class=nx>append</span><span class=p>(</span><span class=nx>script</span><span class=p>);</span>
<span class=w>    </span><span class=p>});</span>
<span class=p>}</span>
</code></pre></div><p class=my-4>Giờ hàm này vẫn gọi như bình thường, còn callback đi đâu chúng ta sẽ tìm hiểu tiếp ở những phần tiếp theo.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>);</span>
</code></pre></div><p class=my-4>Việc thực thi sẽ diễn ra như sau:<ul class="list-[revert] ml-5"><li>Executor sẽ được thực thi khi khởi tạo promise mới.<li>Executor có hai tham số là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code>, đây chính là hai hàm cần phải được gọi khi hoàn thành. Đây là hàm được cung cấp sẵn, chúng ta không cần quan tâm đến nó, chỉ cần sử dụng là được.<li>Executor hoạt động và tuỳ vào kết quả nó sẽ gọi đến một trong hai hàm trên.</ul><p class=my-4>Một lưu ý rằng, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code> hoặc <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code> chỉ có thể được gọi một lần. Dù chúng ta có gọi nhiều lần thì chỉ lần gọi đầu tiên có tác dụng:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>resolve</span><span class=p>(</span><span class=s1>'first resolve'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>reject</span><span class=p>(</span><span class=s1>'error'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>resolve</span><span class=p>(</span><span class=s1>'second resolve'</span><span class=p>)</span>
<span class=p>})</span>
<span class=c1>// trả về Promise {&lt;resolved>: "first resolve"}</span>
<span class=c1>// gọi resolve, reject tiếp theo cũng không có tác dụng</span>
</code></pre></div><p class=my-4>Ngoài ra, các hàm <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code> có thể nhận số lượng tham số tuỳ ý, nhưng sẽ chỉ có tham số đầu tiên được sử dụng làm <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code> cho đối tượng promise, những tham số tiếp theo sẽ bị bỏ qua. Hành động resolve hoạt reject promise này được gọi với thuật ngữ <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">settle</code> promise đó.<p class=my-4>Vậy là chúng ta đã tạo ra đối tượng promise, công việc bây giờ mà chúng ta cần là tìm cách gọi những code tiếp theo cần thực thi khi công việc bất đồng bộ này thành công. Đó cũng chính là nội dung của phần tiếp theo<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=su-dung-then-va-catch><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#su-dung-then-va-catch> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Sử dụng <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code></h3><p class=my-4>Promise cho phép chúng ta liên kết các hoạt động bất đồng bộ với những code cần thực thi (những code cần đến kết quả của hoạt động kia) sau đó rất dễ dàng. Những điều đó có thể thực hiện thông qua <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">.then</code> như sau:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>promise</span><span class=p>.</span><span class=nx>then</span><span class=p>(</span>
<span class=w>    </span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Code trong trường hợp thành công</span>
<span class=w>    </span><span class=p>},</span>
<span class=w>    </span><span class=nx>error</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Code trong trường hợp lỗi</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>);</span>
</code></pre></div><p class=my-4>Tham số đầu tiên được thực thi khi promise được resolve và thành công, còn tham số thứ hai được gọi khi promise bị reject trong trường hợp lỗi.<p class=my-4>Với ví dụ <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">loadScript</code> ở trên, chúng ta có thể thực hiện đơn giản thế này:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=w>    </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>)</span>
<span class=w>        </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span>
<span class=w>            </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nx>$</span><span class=p>(</span><span class=s2>"#test"</span><span class=p>).</span><span class=nx>hide</span><span class=p>();</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=nx>error</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>);</span>
</code></pre></div><p class=my-4>Nếu chúng ta chỉ cần quan tâm đến trường hợp thành công, còn lỗi thì bỏ qua, chúng ta chỉ cần dùng 1 tham số cho <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> là đủ:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>$</span><span class=p>(</span><span class=s2>"#test"</span><span class=p>).</span><span class=nx>hide</span><span class=p>();</span>
<span class=p>});</span>
</code></pre></div><p class=my-4>Nếu chúng ta chỉ quan tâm đến lỗi, chúng ta có thể dùng <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then(null,
errorCallback)</code>. Và trong trường hợp này, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> cho chúng ta cú pháp đẹp hơn:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>).</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=p>})</span>
</code></pre></div><p class=my-4>Việc gọi <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then(null, function)</code> hoàn toàn giống nhau, chúng ta có thể dùng loại nào mình cảm thấy thích. Những hàm được truyền vào <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> hoặc <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> luôn luôn được đảm bảo rằng, chúng chỉ được thực thi khi nào promise được resolve hoặc reject mà thôi. Vì vậy, mọi việc hoạt động bất đồng bộ vẫn luôn được đảm bảo mà không cần lo về lỗi khi code được thực thi khi đang chờ code khác.<p class=my-4>Một lưu ý nữa là các đối tượng promise luôn đóng gói <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">state</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code>, chúng ta không thể truy cập nó từ bên ngoài, mọi thao tác với promise đều cần phải sử dụng những API được cung cấp, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code>, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> là một trong số chúng.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=co-che-trycatch-ngam><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#co-che-trycatch-ngam> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Cơ chế <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">try...catch</code> ngầm</h3><p class=my-4><code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> của promise có một cơ chế rất hay: Nếu có exception, cho dù promise không bị reject, callback vẫn ngầm hiểu rằng promise này trạng thái là rejected. Ví dụ:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>throw</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>();</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span>
<span class=w>    </span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>),</span>
<span class=w>    </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Error occurred'</span><span class=p>)</span>
<span class=p>)</span>
<span class=c1>// Error occurred</span>
</code></pre></div><p class=my-4>Nó hoạt động hoàn toàn giống với:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>());</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span>
<span class=w>    </span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>),</span>
<span class=w>    </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Error occurred'</span><span class=p>)</span>
<span class=p>)</span>
</code></pre></div><h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=timing><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#timing> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Timing</h3><p class=my-4>Để không gây trở ngại cũng như khó khăn cho lập trình viên, các hàm truyền qua <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> hay <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> không bao giờ được gọi đồng bộ. Chúng cũng hoạt động hoàn toàn bất đồng bộ, sẽ được thực thi sau khi toàn bộ code đồng bộ được thư thi hết, ngay cả trong trường hợp promise được resolve ngay lập tức.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=s1>'done'</span><span class=p>)).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'asynchronous'</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'synchronous'</span><span class=p>);</span>
<span class=c1>// Kết quả in ra sẽ là</span>
<span class=c1>// synchronous</span>
<span class=c1>// asynchronous</span>
</code></pre></div><p class=my-4>Về mặt kỹ thuật, những hàm được truyền vào <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> hay <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> sẽ được đưa vào một hàng đợi. Điều này giúp chúng sẽ được thực thi sau, JavaScript engine của trình duyệt sẽ bắt đầu làm việc với hàng đợi này sau khi các code đã được thực thi xong. Và tất nhiên, các hàm trong hàng đợi sẽ được lấy ra khi promise của chúng đã được resolve hoặc reject.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>wait</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>ms</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>ms</span><span class=p>));</span>
<span class=nx>wait</span><span class=p>().</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mf>3</span><span class=p>));</span>
<span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>())</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mf>2</span><span class=p>))</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mf>1</span><span class=p>);</span>
<span class=c1>// Kết quả sẽ là</span>
<span class=c1>// 1</span>
<span class=c1>// 2</span>
<span class=c1>// 3</span>
</code></pre></div><p class=my-4>Và promise cho chúng ta rất nhiều lợi ích so với cách sử dụng callback truyền thống ở trên:<ul class="list-[revert] ml-5"><li>Callback truyền vào <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code>, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> sẽ luôn được đảm bảo là không được thực thi khi mà các code JavaScript tiếp theo vẫn chưa hoàn thành. Trong phần lớn các trường hợp thì điều này không có nhiều ý nghĩa, tuy nhiên, nó vẫn cần thiết trong một vài trường hợp đặc biệt mà thứ tự code được thực thi sẽ cho kết quả khác nhau.<li>Các callback được truyền vào <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> luôn được gọi, kể cả trường hợp nó được thêm vào sau khi promise được settle, và sau cả một vài code đồng bộ khác. Ví dụ: ::javascript const x = new Promise(resolve => resolve(2)); console.log(1); x.then(console.log); // Kết quả: // 1 // 2<li>Hoạt động của <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> cũng là bất đồng bộ, và kết quả trả về sau khi gọi hai hàm này cũng là một promise, điều đó cho phép chúng ta có thể gọi <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> liên tiếp để thực hiện nhiều công việc bất đồng bộ khác nhau.</ul><h2 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-3xl text-slate-900 dark:text-slate-100" id=promise-chain><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#promise-chain> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Promise chain</h2><p class=my-4>Một nhu cầu rất chính đáng của chúng ta là cần phải thực thi hai hoặc nhiều hơn các hoạt động bất đồng bộ, theo thứ tự lần lượt từng thứ kết thúc một. Trong nhiều trường hợp, chúng ta còn phải sử dụng kết quả của hành động trước để có thể tiến hành các hoạt động tiếp theo.<p class=my-4>Promise có thể giúp chúng ta trong việc này.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>doSomething</span><span class=p>();</span>
<span class=kd>const</span><span class=w> </span><span class=nx>promise2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>promise1</span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>successCallback</span><span class=p>,</span><span class=w> </span><span class=nx>failureCallback</span><span class=p>);</span>
</code></pre></div><p class=my-4>hoặc viết ngắn gọn hơn:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>doSomething</span><span class=p>().</span><span class=nx>then</span><span class=p>(</span><span class=nx>successCallback</span><span class=p>,</span><span class=w> </span><span class=nx>failureCallback</span><span class=p>);</span>
</code></pre></div><p class=my-4>Như đã nói ở trên, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> sẽ trả về một promise, và promise này không chỉ là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">doSomething</code> đã hoàn thành mà cả <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">successCallback</code> cũng đã hoàn thành (có thể là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">failureCallback</code> trong trường hợp lỗi). Nhờ đó, chúng ta có thể tiếp tục sử dụng promise này cho những hành động tiếp theo. Trong trường hợp đó, những callback được truyền cho <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">promise2</code> sẽ cũng se được đưa vào hàng đợi, và đương nhiên, chúng phải xếp hàng ở phía sau.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=chain-on-gian-voi-gia-tri-uoc-tra-ve><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#chain-on-gian-voi-gia-tri-uoc-tra-ve> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Chain đơn giản với giá trị được trả về</h3><p class=my-4>Nói đơn giản, sau mỗi bước, một promise sẽ được trả về, và nó đại diện cho kết quả của bước đó. Cách làm này giúp chúng ta không phải truyền callback, mà sử dụng kết quả của promise để tiến hành các hoạt động tiếp theo. Lưu ý rằng, nếu muốn sử dụng kết quả của bước trước ở bước tiếp theo, chúng ta cần <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">return</code> kết quả đó. Để dễ hiểu hơn, hãy xem xét một ví dụ sau:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>)).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w>  </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>;</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>;</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>;</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=p>})</span>
<span class=c1>// Kết quả sẽ là</span>
<span class=c1>// 1</span>
<span class=c1>// 2</span>
<span class=c1>// 4</span>
<span class=c1>// 8</span>
</code></pre></div><p class=my-4>Hơi ngoài lề một chút, nhưng chúng ta có thể sử dụng nhiều <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> với cùng một promise mà không chain. Điều này là hoàn toàn hợp lệ, về mặt kỹ thuật. Nhưng khác với chain, tất cả <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> của cùng một promise sẽ có cùng một kết quả. Trong thực tế thì việc này không được nhiều người sử dụng, mà chain mới là thứ chúng ta cần.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>));</span>
<span class=nx>promise</span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>;</span>
<span class=p>})</span>
<span class=nx>promise</span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>;</span>
<span class=p>})</span>
<span class=nx>promise</span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>;</span>
<span class=p>})</span>
<span class=nx>promise</span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=p>})</span>
<span class=c1>// Kết quả:</span>
<span class=c1>// 1</span>
<span class=c1>// 1</span>
<span class=c1>// 1</span>
<span class=c1>// 1</span>
</code></pre></div><h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=return-mot-promise><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#return-mot-promise> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Return một promise</h3><p class=my-4>Trong ví dụ trên, chúng ta chỉ đơn giản là return một giá trị và giá trị đó được sử dụng trong chain. Nhưng chúng ta hoàn toàn có thể return một promise khác, trong trường hợp chúng ta muốn thêm hoạt động bất đồng bộ khác.<p class=my-4>Nếu promise được return, callback được truyền vào trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> sẽ không được thực hiện ngay, mà nó sẽ phải chờ promise đó được resolve hoặc reject thì mới được thực thi. Khi đó, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code> của promise sẽ được sử dụng.<p class=my-4>Quay lại với ví dụ load script của chúng ta, với mỗi hoạt động load script là một promise, và vì mỗi script lại được load bất đồng bộ nên thông thường suy nghĩ của chúng ta sẽ là thế này:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script1.js'</span><span class=p>).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script2.js'</span><span class=p>).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script3.js'</span><span class=p>).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>                  </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script4.js'</span><span class=p>).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>                      </span><span class=c1>// Code sau khi tất cả các hoạt động bất đồng</span>
<span class=w>                      </span><span class=c1>// bộ hoàn thành.</span>
<span class=w>                  </span><span class=p>})</span>
<span class=w>              </span><span class=p>})</span>
<span class=w>        </span><span class=p>})</span>
<span class=w>  </span><span class=p>})</span>
</code></pre></div><p class=my-4>Về cơ bản thì lại là một kim tự tháp khác thôi mà, đây là trường hợp callback không <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">return</code> bất cứ một kết quả gì. Nhưng với promise, thì chúng ta không cần phải làm như vậy. JavaScript đã giải quyết vấn đề này giúp chúng ta rồi. Khi <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> có thể trả về một promise, và khi nó trả về một promise thì promise đó phải hoàn thành thì mới tới bước tiếp theo, nên chúng ta có thể code trông rất đẹp như sau:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script1.js'</span><span class=p>)</span>
<span class=w>  </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script2.js'</span><span class=p>))</span>
<span class=w>  </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script3.js'</span><span class=p>))</span>
<span class=w>  </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'script4.js'</span><span class=p>))</span>
<span class=w>  </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=c1>// Code sau khi tất cả các hoạt động bất đồng</span>
<span class=w>      </span><span class=c1>// bộ hoàn thành.</span>
<span class=w>  </span><span class=p>})</span>
</code></pre></div><p class=my-4>Sử dụng promise giúp chúng ta xây dựng được chuỗi các hoạt động bất đồng bộ một cách rất dễ dàng. Ví dụ load script này có thể không thấy được kết quả ngay nên sẽ khó hình dung. Để rõ hơn, chúng ta có thể xem ví dụ sau:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>));</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>));</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>2</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>))</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=p>})</span>
</code></pre></div><p class=my-4>Ví dụ này có thể kiểm chứng ngay trong console của trình duyệt. Khi chạy, sau mỗi giây nó sẽ in ra một số, lần lượt sẽ là<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code>1
2
4
8
</code></pre></div><p class=my-4>Flow ở đây rất dễ hiểu:<ul class="list-[revert] ml-5"><li>Khi promise đầu tiên được resolve sau 1 giây, nó trả về kết quả và được callback trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> sử dụng.<li>Callback này in ra kết quả và trả về một promise mới.<li>Vì promise mới này cũng cần 1 giây để hoàn thành, nên callback trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> tiếp theo chưa được thực thi ngay.<li>Nó đợi đến khi promise được resolve mới bắt đầu thực thi, lúc nào nó in ra kết quả <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">2</code> và trả về promise mới.<li>Quá trình cứ tiếp tục như vậy cho đến khi hết các callback.</ul><p class=my-4>Đây là cách hoạt động của promise chain, nó cho chúng ta code chuỗi các hoạt động bất đồng bộ một cách dễ dàng mà không phải sử dụng code kiểu lồng nhau, nguy cơ rất lớn dẫn đến callback hell. Có thể thấy đây chính là điểm mấu chốt của promise chain. Chúng ta cứ tạm hiểu rằng, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">return</code> một giá trị xác định là một biến thể của hình thức này, khi đó JavaScript sẽ “ngầm” tạo ra một promise được resolve ngay với giá trị đó.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=xu-ly-khi-gap-loi_1><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#xu-ly-khi-gap-loi_1> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Xử lý khi gặp lỗi</h3><p class=my-4>Trong những ví dụ ở trên, chúng ta mới chỉ quan tâm đến việc các hoạt động bất đồng bộ kết thúc thành công. Tuy nhiên, không thể đảm bảo rằng, tất cả chúng sẽ luôn thành công như vậy. Trong trường hợp lỗi, tất nhiên là promise sẽ bị reject thay vì resolve.<p class=my-4>Và một nhu cầu tất yếu (dù không thường xuyên) là cần phải giải quyết hậu quả khi có lỗi xảy ra. Promise chain có một cơ chế tuyệt vời giúp chúng ta làm việc đó.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>doSomething</span><span class=p>()</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>doSomethingEles</span><span class=p>())</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>newResult</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>doOtherThing</span><span class=p>())</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>finalResult</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>      </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`I got the final result: </span><span class=si>${</span><span class=nx>finalResult</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>failureCallback</span><span class=p>)</span>
</code></pre></div><p class=my-4>Promise chain có một cơ chế rất hay, khi một promise bị reject, ngay lập tức, nó sẽ thực thi code xử lý gần nhất trong chuỗi. Cách làm này tương tự như cơ chế <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">try...catch</code> thông thường.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=k>try</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>result</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>syncDoSomething</span><span class=p>();</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>newResult</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>syncDoSomethingElse</span><span class=p>(</span><span class=nx>result</span><span class=p>);</span>
<span class=w>    </span><span class=kd>const</span><span class=w> </span><span class=nx>finalResult</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nx>syncDoOtherThing</span><span class=p>(</span><span class=nx>newResult</span><span class=p>);</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`I got the final result: </span><span class=si>${</span><span class=nx>finalResult</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
<span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>failureCallback</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p class=my-4>Giờ hãy nhìn lại một chút ví dụ về load script của chúng ta, bạn có thể nhận ra rằng, trong cách làm callback truyền thống, chúng ta phải gọi <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">failureCallback</code> tới ba lần, trong khi cơ chế promise chain cho phép chúng ta chỉ cần gọi 1 lần là đủ.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//code.jquery.com/jquery-3.3.1.min.js'</span><span class=p>)</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'wrong-script-path.js'</span><span class=p>))</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>loadScript</span><span class=p>(</span><span class=s1>'//cdn.jsdelivr.net/npm/lodash@4.17.10/lodash.min.js'</span><span class=p>))</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'All scripts loaded'</span><span class=p>))</span>
<span class=w>    </span><span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>error</span><span class=p>))</span>
<span class=c1>// Kết quả sẽ là</span>
<span class=c1>// Error: script not loaded</span>
<span class=c1>//     at HTMLScriptElement.script...</span>
</code></pre></div><p class=my-4>Ở phần trước, chúng ta biết rằng, promise có một cơ chế <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">try...catch</code> ngầm. Nhưng đó là cơ chế đối với executor, vậy với các callback trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> thì sao?<p class=my-4>Thật tuyệt vời là cơ chế đó cũng tồn tại trong promise chain. Khi một callback nào đó có exception, nó cũng ngay lập tức coi đó là reject một promise và nhảy đến <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> gần nhất.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=s1>'ok'</span><span class=p>))</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>();</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=p>.</span><span class=k>catch</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Error occurred'</span><span class=p>))</span>
</code></pre></div><p class=my-4>Lưu ý rằng, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> ở đây vẫn là cách viết ngắn gọn của <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then(null,
function)</code>. Chúng ta hoàn toàn có thể dùng cú pháp đầy đủ cũng không vấn đề gì:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=s1>'ok'</span><span class=p>))</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>();</span>
<span class=w>    </span><span class=p>})</span>
<span class=w>    </span><span class=p>.</span><span class=nx>then</span><span class=p>(</span>
<span class=w>        </span><span class=nx>result</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>result</span><span class=p>),</span>
<span class=w>        </span><span class=p>()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Error occurred'</span><span class=p>)</span>
<span class=w>    </span><span class=p>)</span>
</code></pre></div><p class=my-4>Một tác dụng phụ không mong muốn của cơ chế này là bất cứ exception nào (kể cả lỗi cú pháp) cũng bị coi là reject và nhảy đến catch gần nhất. Do đó, trong quá trình debug, đây có thể là một trở ngại rất lớn.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=chain-tiep-theo-catch><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#chain-tiep-theo-catch> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Chain tiếp theo <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code></h3><p class=my-4>Chúng ta có thể dùng <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> ở bất cứ đâu, không nhất thiết là ở cuối cùng. Đơn giản là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> cũng trả về một promise nên nó hoàn toàn có thể tiếp tục chain được. Chúng ta có thể dùng cách này để thực hiện một số hành động cần phải chạy trong cả trường hợp thành công và lỗi.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Init'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>resolve</span><span class=p>();</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>throw</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>();</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Do this'</span><span class=p>);</span>
<span class=p>}).</span><span class=k>catch</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Do that'</span><span class=p>);</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Do this, no matter when happened'</span><span class=p>)</span>
<span class=p>})</span>
<span class=c1>// Kết quả sẽ là</span>
<span class=c1>// Init</span>
<span class=c1>// Do that</span>
<span class=c1>// Do this, no matter what happened</span>
</code></pre></div><p class=my-4>Lưu ý rằng, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Do this</code> không được in ra bởi vì có exception xảy ra, và nó coi như một promise bị reject. Hơn nữa, trong trường hợp trên, nếu <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> không được thực thi (nếu không có lỗi nào xảy ra) thì <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> sau nó vẫn được thực thi như thường:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Init'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>resolve</span><span class=p>();</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Do this'</span><span class=p>);</span>
<span class=p>}).</span><span class=k>catch</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Do that'</span><span class=p>);</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Do this, no matter when happened'</span><span class=p>)</span>
<span class=p>})</span>
<span class=c1>// Kết quả sẽ là</span>
<span class=c1>// Init</span>
<span class=c1>// Do this</span>
<span class=c1>// Do this, no matter what happened</span>
</code></pre></div><p class=my-4>Như vậy, chúng ta có thể đặt <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> ở bất cứ đâu mà chúng ta cần để xử lý lỗi. Thậm chí chúng ta có thể sử dụng kết hợp nhiều <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">then</code> và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> để xử lý những lỗi khác nhau ở những giai đoạn khác nhau. Và mỗi giai đoạn như vậy, nếu là lỗi không xử lý được có thể throw lỗi đó để nhảy đến bước tiếp theo. Trong một chain nếu có nhiều <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> thì khi có lỗi xảy ra, JavaScript engine sẽ thực thi code ở <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">catch</code> gần nhất.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Init'</span><span class=p>);</span>
<span class=w>    </span><span class=nx>resolve</span><span class=p>();</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>throw</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>();</span>
<span class=p>}).</span><span class=k>catch</span><span class=p>((</span><span class=nx>error</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=nx>error</span><span class=w> </span><span class=ow>instanceof</span><span class=w> </span><span class=ne>EvalError</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Do this'</span><span class=p>);</span>
<span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=nx>error</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}).</span><span class=nx>then</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'This will run only if error is handled'</span><span class=p>)</span>
<span class=p>}).</span><span class=k>catch</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'unhandled error here'</span><span class=p>)</span>
<span class=p>})</span>
<span class=c1>// Kết quả</span>
<span class=c1>// Init</span>
<span class=c1>// Unhandled error here</span>
</code></pre></div><h2 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-3xl text-slate-900 dark:text-slate-100" id=promise-api><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#promise-api> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Promise API</h2><p class=my-4>Có 1 phương thức mà Promise cung cấp cho chúng ta, trong phần này, chúng ta sẽ tìm hiểu các phương thức đó.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=resolve><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#resolve> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a><code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code></h3><p class=my-4>Phương thức cho chúng ta cách tắt để tạo một promise được resolve mới.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Promise</span><span class=p>.</span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>);</span>
</code></pre></div><p class=my-4>Code trên hoàn toàn tương đương với:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>));</span>
</code></pre></div><p class=my-4>Phương thức này cho chúng ta một cách ngắn gọn để tạo promise mà giá trị của nó được xác định sẵn.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=reject><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#reject> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a><code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code></h3><p class=my-4>Tương tự như <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">resolve</code>, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">reject</code> cũng là một phương thức cho chúng ta tạo ra một promise bị reject một cách nhanh chóng:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Promise</span><span class=p>.</span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>());</span>
</code></pre></div><p class=my-4>Code trên hoàn toàn tương đương với:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>()));</span>
</code></pre></div><p class=my-4>Tuy nhiên, khác với <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.resolve</code>, phương thức này ít được sử dụng trong thực tế.<h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=all><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#all> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a><code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">all</code></h3><p class=my-4>Đây là phương thức cho chúng ta cơ chế thực thi nhiều promise song song với nhau. Và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.all</code> chỉ kết thúc và trả về kết quả khi tất cả các promise đã được “settle”.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=kd>const</span><span class=w> </span><span class=nx>promise</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>(</span><span class=nx>iterable</span><span class=p>);</span>
</code></pre></div><p class=my-4>Tham số <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">iterable</code> thường là một array các promise (về mặt kỹ thuật, bất cứ đối tượng iterable nào cũng được). Và kết quả của phương thức này là một promise, promise này được resolve nếu tất cả các promise trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">iterable</code> được resolve, và <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code> của nó sẽ là một array các <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code> của từng promise.<p class=my-4>Ví dụ, đoạn code sau sẽ được thự thi và sau 3 giây, một promise mới được resolve với giá trị <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">[1, 2, 3]</code> sẽ được trả về:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>),</span><span class=w> </span><span class=mf>3000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>2</span><span class=p>),</span><span class=w> </span><span class=mf>2000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>3</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=p>]).</span><span class=nx>then</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả:</span>
<span class=c1>// [1, 2, 3]</span>
</code></pre></div><p class=my-4>Giá trị trả về trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">result</code> của <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.all</code> sẽ tương ứng với thứ tự của các promise trong <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">iterable</code>, dù thời gian thực thi của các promise đó có thể nhanh chậm khác nhau.<p class=my-4>Trong trường hợp có một promise nào đó bị reject, <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.all</code> sẽ ngay lập tức trả về một promise với lỗi đó.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>),</span><span class=w> </span><span class=mf>3000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>()),</span><span class=w> </span><span class=mf>2000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>3</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=p>]).</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả:</span>
<span class=c1>// Error</span>
<span class=c1>//    at setTimeout (&lt;anonymous>:3:62)</span>
</code></pre></div><p class=my-4>Trong đoạn code trên, promise thứ hai bị reject sau hai giây, do đó, kết quả trả về của <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.all</code> là một promise bị reject với đúng lỗi đó. Trong trường hợp có nhiều lỗi thì chỉ có lỗi đầu tiên được ghi nhận:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>'Error 1'</span><span class=p>)),</span><span class=w> </span><span class=mf>3000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>'Error 2'</span><span class=p>)),</span><span class=w> </span><span class=mf>2000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>3</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=p>]).</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả</span>
<span class=c1>// Error: Error 2</span>
<span class=c1>//    at setTimeout (&lt;anonymous>:3:62)</span>
</code></pre></div><p class=my-4>Tuy nhiên, cũng cần lưu ý rằng, các promise được chạy song song và dù một promise bị reject thì chúng ta cũng không có cách nào để dừng các promise khác lại được. Chúng vẫn sẽ tiếp tục chạy cho tới khi “settle” nhưng kết quả sẽ bị bỏ qua.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'this will not stop'</span><span class=p>),</span><span class=w> </span><span class=mf>3000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>(</span><span class=s1>'Error 2'</span><span class=p>)),</span><span class=w> </span><span class=mf>2000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>3</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=p>]).</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả</span>
<span class=c1>// Error: Error 2</span>
<span class=c1>//    at setTimeout (&lt;anonymous>:3:62)</span>
<span class=c1>// this will not stop</span>
</code></pre></div><p class=my-4>Một điều vi diệu là <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.all</code> nhận một iterable thường là một array các promise. Nhưng thực ra chúng ta có thể dùng bất cứ giá trị nào, trong trường hợp một giá trị được truyền vào, nó sẽ tự động hiểu điều đó tương đương với <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.resolve(value)</code>.<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=w>    </span><span class=mf>2</span><span class=p>,</span>
<span class=w>    </span><span class=mf>3</span><span class=p>,</span>
<span class=p>]).</span><span class=nx>then</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả là:</span>
<span class=c1>// [1, 2, 3]</span>
</code></pre></div><h3 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-2xl text-slate-900 dark:text-slate-100" id=race><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#race> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a><code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">race</code></h3><p class=my-4><code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.race</code> tương tự như <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.all</code>, cũng nhận một iterable các promise, nhưng thay vì đợi tất cả các promise kết thúc, nó chỉ đợi một promise được “settle” và trả kết quả về chính promise đó.<p class=my-4>Ví dụ:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>race</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>),</span><span class=w> </span><span class=mf>3000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>3</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>()),</span><span class=w> </span><span class=mf>2000</span><span class=p>)),</span>
<span class=p>]).</span><span class=nx>then</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả</span>
<span class=c1>// 3</span>
</code></pre></div><p class=my-4>Kể cả trong trường hợp lỗi thì nó vẫn trả về promise đầu tiên:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>race</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>1</span><span class=p>),</span><span class=w> </span><span class=mf>3000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>3</span><span class=p>),</span><span class=w> </span><span class=mf>2000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span><span class=w> </span><span class=nx>reject</span><span class=p>)</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>reject</span><span class=p>(</span><span class=ow>new</span><span class=w> </span><span class=ne>Error</span><span class=p>()),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=p>]).</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả:</span>
<span class=c1>// Error</span>
<span class=c1>//    at setTimeout (&lt;anonymous>:4:62)</span>
</code></pre></div><p class=my-4>Và cũng tương tự như <code class="bg-slate-100 p-0.5 dark:bg-slate-900 text-[90%]">Promise.all</code>, khi promise đầu tiên đã “settle”, thì những promise khác cũng không được dừng lại, mà nó vẫn tiếp tục chạy cho đến khi đến thúc, tuy nhiên, kết quả của chúng sẽ bị bỏ qua:<div class="chl my-4 p-4 bg-slate-100 dark:bg-slate-900 overflow-auto"><pre class=text-sm><code><span class=nb>Promise</span><span class=p>.</span><span class=nx>race</span><span class=p>([</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'this will not stop'</span><span class=p>),</span><span class=w> </span><span class=mf>3000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>2</span><span class=p>),</span><span class=w> </span><span class=mf>2000</span><span class=p>)),</span>
<span class=w>    </span><span class=ow>new</span><span class=w> </span><span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>setTimeout</span><span class=p>(()</span><span class=w> </span><span class=p>=></span><span class=w> </span><span class=nx>resolve</span><span class=p>(</span><span class=mf>3</span><span class=p>),</span><span class=w> </span><span class=mf>1000</span><span class=p>)),</span>
<span class=p>]).</span><span class=nx>then</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>);</span>
<span class=c1>// Kết quả:</span>
<span class=c1>// 3</span>
<span class=c1>// this will not stop</span>
</code></pre></div><h2 class="group font-semibold mt-8 mb-4 pb-2 border-b border-slate-100 dark:border-slate-700 text-3xl text-slate-900 dark:text-slate-100" id=ket-luan><a class="md:opacity-0 group-hover:opacity-100 float-left -ml-5 pr-1 leading-none" title="Permanent link" href=#ket-luan> <svg class="size-4 inline-block" viewbox="0 0 24 24" fill=none height=16 stroke=currentColor width=16 xmlns=http://www.w3.org/2000/svg><path d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" stroke-linecap=round stroke-linejoin=round stroke-width=2></path></svg> </a>Kết luận</h2><p class=my-4>Promise là một phương án giúp chúng ta code bất đồng bộ trong JavaScript tốt hơn. Nó cho phép chúng ta phòng tránh callback hell và đóng gói các hoạt động bất đồng bộ, giúp chúng ta có thể code tốt hơn, xử lý lỗi dễ hơn. Đặc biệt là promise chain cho chúng ta khả năng code một chuỗi các hoạt động bất đồng bộ nối tiếp nhau.</div><div class="mt-8 text-sm leading-relaxed"><svg class="inline size-4" viewbox="0 0 24 24" fill=none stroke=currentColor xmlns=http://www.w3.org/2000/svg><path d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg><a class="text-crimson hover:text-slate-600 cursor-pointer dark:hover:text-slate-300" href=https://manhhomienbienthuy.github.io/tag/javascript.html> #JavaScript </a><a class="text-crimson hover:text-slate-600 cursor-pointer dark:hover:text-slate-300" href=https://manhhomienbienthuy.github.io/tag/promise.html> #Promise </a><a class="text-crimson hover:text-slate-600 cursor-pointer dark:hover:text-slate-300" href=https://manhhomienbienthuy.github.io/tag/async.html> #async </a><a class="text-crimson hover:text-slate-600 cursor-pointer dark:hover:text-slate-300" href=https://manhhomienbienthuy.github.io/tag/await.html> #await </a></div></div><div class="flex justify-between items-center my-10 text-sm"><div class="grow text-left"><a class="p-2 text-white bg-crimson" href=https://manhhomienbienthuy.github.io/2018/07/17/javascript-asyncawait.html> <svg class="inline size-4" viewbox="0 2 24 24" fill=none stroke=currentColor xmlns=http://www.w3.org/2000/svg><path d="M10 19l-7-7m0 0l7-7m-7 7h18" stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> Bài viết sau </a></div><div class="grow text-right"><a class="p-2 text-white bg-crimson" href=https://manhhomienbienthuy.github.io/2018/05/20/tai-sao-nen-su-dung-eslint-cho-du-an.html> Bài viết trước <svg class="inline size-4" viewbox="0 2 24 24" fill=none stroke=currentColor xmlns=http://www.w3.org/2000/svg><path d="M14 5l7 7m0 0l-7 7m7-7H3" stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> </a></div></div><div class="mb-8 p-8 text-justify bg-white shadow-lg dark:bg-slate-800"><p class="mb-2 italic leading-relaxed">Tôi xin lỗi nếu bài viết có bất kỳ typo nào. Nếu bạn nhận thấy điều gì bất thường, xin hãy cho tôi biết.<p class="mb-8 leading-relaxed">Nếu có bất điều gì muốn nói, bạn có thể liên hệ với tôi qua các mạng xã hội, tạo discussion hoặc report issue trên Github.<div class="flex justify-between mb-4 text-slate-900 dark:text-slate-100"><a rel="noopener noreferrer" href=https://x.com/_naa_4f target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>X</title><path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/></svg> </a><a rel="noopener noreferrer" href=https://www.linkedin.com/in/manhhomienbienthuy target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>LinkedIn</title><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/></svg> </a><a rel="noopener noreferrer" href=https://www.facebook.com/manhhomienbienthuy target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>Facebook</title><path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"/></svg> </a><a rel="noopener noreferrer" href=https://github.com/manhhomienbienthuy target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>Github</title><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg> </a><a rel="noopener noreferrer" href=https://github.com/manhhomienbienthuy/manhhomienbienthuy.github.io/discussions target=_blank> <svg viewbox="0 0 24 24" class=size-6 fill=none stroke=currentColor xmlns=http://www.w3.org/2000/svg><title>Discussion</title><path d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z" stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> </a><a rel="noopener noreferrer" href=https://github.com/manhhomienbienthuy/manhhomienbienthuy.github.io/issues target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>Issue</title><path d="M4.355.522a.5.5 0 0 1 .623.333l.291.956A4.979 4.979 0 0 1 8 1c1.007 0 1.946.298 2.731.811l.29-.956a.5.5 0 1 1 .957.29l-.41 1.352A4.985 4.985 0 0 1 13 6h.5a.5.5 0 0 0 .5-.5V5a.5.5 0 0 1 1 0v.5A1.5 1.5 0 0 1 13.5 7H13v1h1.5a.5.5 0 0 1 0 1H13v1h.5a1.5 1.5 0 0 1 1.5 1.5v.5a.5.5 0 1 1-1 0v-.5a.5.5 0 0 0-.5-.5H13a5 5 0 0 1-10 0h-.5a.5.5 0 0 0-.5.5v.5a.5.5 0 1 1-1 0v-.5A1.5 1.5 0 0 1 2.5 10H3V9H1.5a.5.5 0 0 1 0-1H3V7h-.5A1.5 1.5 0 0 1 1 5.5V5a.5.5 0 0 1 1 0v.5a.5.5 0 0 0 .5.5H3c0-1.364.547-2.601 1.432-3.503l-.41-1.352a.5.5 0 0 1 .333-.623zM4 7v4a4 4 0 0 0 3.5 3.97V7H4zm4.5 0v7.97A4 4 0 0 0 12 11V7H8.5zM12 6a3.989 3.989 0 0 0-1.334-2.982A3.983 3.983 0 0 0 8 2a3.983 3.983 0 0 0-2.667 1.018A3.989 3.989 0 0 0 4 6h8z"/></svg> </a></div></div></div><div class="md:col-span-2 shrink-0 p-6 bg-white text-sm leading-relaxed shadow-[0_2px_20px_-10px_#000] dark:bg-slate-800"><h2 class="mb-2 font-semibold text-slate-900 uppercase dark:text-slate-100 after:block after:h-px after:w-8 after:mb-4 after:bg-slate-900 after:shadow-heading dark:after:bg-slate-100 dark:after:shadow-heading-dark">Welcome</h2><img class="w-3/4 mx-auto mb-4 rounded-full" alt=manhhomienbienthuy height=262 src=https://manhhomienbienthuy.github.io/meow.webp width=262><p class="mb-10 text-center">Đây là thế giới của manhhomienbienthuy (naa). Chào mừng đến với thế giới của tôi!<h2 class="mb-2 font-semibold text-slate-900 uppercase dark:text-slate-100 after:block after:h-px after:w-8 after:mb-4 after:bg-slate-900 after:shadow-heading dark:after:bg-slate-100 dark:after:shadow-heading-dark">Bài viết liên quan</h2><div class="mb-10 divide-y divide-slate-100 dark:divide-slate-700"><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-sm" href=https://manhhomienbienthuy.github.io/2018/07/17/javascript-asyncawait.html> <img alt="Javascript: async/await" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1516116216624-53e697fedbea?ixlib=rb-4.0.3&w=640&q=80&fm=webp&crop=entropy&cs=tinysrgb" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2018/07/17/javascript-asyncawait.html> Javascript: async/await </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-sm" href=https://manhhomienbienthuy.github.io/2023/01/24/xu-ly-loi-cho-express-route.html> <img alt="Xử lý lỗi cho Express route" class="size-full p-1 object-cover" decoding=async height=64 loading=lazy src=https://cdn.pixabay.com/photo/2013/04/01/07/43/problem-98377_640.jpg width=64> </a><a href=https://manhhomienbienthuy.github.io/2023/01/24/xu-ly-loi-cho-express-route.html> Xử lý lỗi cho Express route </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-sm" href=https://manhhomienbienthuy.github.io/2024/06/18/tinh-toan-song-song-trong-nodejs.html> <img alt="Tính toán song song trong Node.js" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1613490900233-141c5560d75d?ixlib=rb-4.0.3&q=85&fm=webp&crop=entropy&cs=srgb&w=640" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2024/06/18/tinh-toan-song-song-trong-nodejs.html> Tính toán song song trong Node.js </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-sm" href=https://manhhomienbienthuy.github.io/2024/05/31/gioi-thieu-service-worker.html> <img alt="Giới thiệu service worker" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1614213951697-a45781262acf?ixlib=rb-4.0.3&q=85&fm=webp&crop=entropy&cs=srgb&w=640" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2024/05/31/gioi-thieu-service-worker.html> Giới thiệu service worker </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-sm" href=https://manhhomienbienthuy.github.io/2022/04/11/nodejs-blocking-non-blocking-io.html> <img alt="Node.js: Blocking & Non-blocking I/O" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1576269076940-31c888bebb3e?ixlib=rb-4.0.3&w=640&q=80&fm=webp&crop=entropy&cs=tinysrgb" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2022/04/11/nodejs-blocking-non-blocking-io.html> Node.js: Blocking & Non-blocking I/O </a></div></div><h2 class="mb-2 font-semibold text-slate-900 uppercase dark:text-slate-100 after:block after:h-px after:w-8 after:mb-4 after:bg-slate-900 after:shadow-heading dark:after:bg-slate-100 dark:after:shadow-heading-dark">Bài viết mới</h2><div class="mb-10 divide-y divide-slate-100 dark:divide-slate-700"><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-[0_0_10px_-5px_#000]" href=https://manhhomienbienthuy.github.io/2025/09/11/design-pattern-co-that-su-than-thanh.html> <img alt="Design pattern có thật sự thần thánh?" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1702588209799-5ea7217b7321?ixlib=rb-4.1.0&q=85&fm=webp&crop=entropy&cs=srgb&w=640" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2025/09/11/design-pattern-co-that-su-than-thanh.html> Design pattern có thật sự thần thánh? </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-[0_0_10px_-5px_#000]" href=https://manhhomienbienthuy.github.io/2025/07/07/mo-hinh-ngon-ngu-lon-llm-dot-pha-trong-generative-ai.html> <img alt="Mô hình ngôn ngữ lớn (LLM): đột phá trong Generative AI" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1697577418970-95d99b5a55cf?ixlib=rb-4.1.0&q=85&fm=webp&crop=entropy&cs=srgb&w=640" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2025/07/07/mo-hinh-ngon-ngu-lon-llm-dot-pha-trong-generative-ai.html> Mô hình ngôn ngữ lớn (LLM): đột phá trong Generative AI </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-[0_0_10px_-5px_#000]" href=https://manhhomienbienthuy.github.io/2025/06/10/domain-driven-design-ddd-khai-niem-nguyen-tac-va-ung-dung.html> <img alt="Domain-Driven Design (DDD): khái niệm, nguyên tắc và ứng dụng" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1576595580361-90a855b84b20?ixlib=rb-4.1.0&q=85&fm=webp&crop=entropy&cs=srgb&w=640" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2025/06/10/domain-driven-design-ddd-khai-niem-nguyen-tac-va-ung-dung.html> Domain-Driven Design (DDD): khái niệm, nguyên tắc và ứng dụng </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-[0_0_10px_-5px_#000]" href=https://manhhomienbienthuy.github.io/2025/05/14/hieu-ve-meta-programming.html> <img alt="Hiểu về meta programming" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1541701494587-cb58502866ab?ixlib=rb-4.1.0&q=85&fm=webp&crop=entropy&cs=srgb&w=640" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2025/05/14/hieu-ve-meta-programming.html> Hiểu về meta programming </a></div><div class="flex items-center gap-2 py-6"><a class="shrink-0 size-16 shadow-[0_0_10px_-5px_#000]" href=https://manhhomienbienthuy.github.io/2025/04/01/bff-backends-for-frontends.html> <img alt="BFF: Backends For Frontends" class="size-full p-1 object-cover" src="https://images.unsplash.com/photo-1509644851169-2acc08aa25b5?ixlib=rb-4.0.3&q=85&fm=webp&crop=entropy&cs=srgb&w=640" decoding=async height=64 loading=lazy width=64> </a><a href=https://manhhomienbienthuy.github.io/2025/04/01/bff-backends-for-frontends.html> BFF: Backends For Frontends </a></div></div><h2 class="mb-2 font-semibold text-slate-900 uppercase dark:text-slate-100 after:block after:h-px after:w-8 after:mb-4 after:bg-slate-900 after:shadow-heading dark:after:bg-slate-100 dark:after:shadow-heading-dark">Chuyên mục</h2><div class="flex flex-wrap gap-2 mb-10 text-xs dark:border-slate-100"><a class="py-1 px-2 text-white uppercase bg-crimson" href=https://manhhomienbienthuy.github.io/category/cuoc-song.html> Cuộc sống </a><a class="py-1 px-2 text-white uppercase bg-crimson" href=https://manhhomienbienthuy.github.io/category/du-lich.html> Du lịch </a><a class="py-1 px-2 text-white uppercase bg-crimson" href=https://manhhomienbienthuy.github.io/category/lap-trinh.html> Lập trình </a><a class="py-1 px-2 text-white uppercase bg-crimson" href=https://manhhomienbienthuy.github.io/category/tong-hop.html> Tổng hợp </a></div><h2 class="mb-2 font-semibold text-slate-900 uppercase dark:text-slate-100 after:block after:h-px after:w-8 after:mb-4 after:bg-slate-900 after:shadow-heading dark:after:bg-slate-100 dark:after:shadow-heading-dark">Lưu trữ theo năm</h2><div class="flex flex-wrap gap-[0.57rem] mb-10 text-xs"><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2025/> 2025 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2024/> 2024 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2023/> 2023 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2022/> 2022 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2021/> 2021 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2020/> 2020 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2019/> 2019 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2018/> 2018 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2017/> 2017 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2016/> 2016 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2015/> 2015 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2014/> 2014 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2013/> 2013 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2012/> 2012 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2011/> 2011 </a><a class="py-1 w-10 text-white text-center bg-crimson" href=https://manhhomienbienthuy.github.io/2010/> 2010 </a></div><h2 class="mb-2 font-semibold text-slate-900 uppercase dark:text-slate-100 after:block after:h-px after:w-8 after:mb-4 after:bg-slate-900 after:shadow-heading dark:after:bg-slate-100 dark:after:shadow-heading-dark">Thông tin liên hệ</h2><p class="mb-8 text-justify">Cảm ơn bạn đã quan tâm blog của tôi. Nếu có bất điều gì muốn nói, bạn có thể liên hệ với tôi qua các mạng xã hội, tạo discussion hoặc report issue trên Github.<div class="flex justify-between mb-8 text-slate-900 dark:text-slate-100"><a rel="noopener noreferrer" href=https://x.com/_naa_4f target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>X</title><path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/></svg> </a><a rel="noopener noreferrer" href=https://www.linkedin.com/in/manhhomienbienthuy target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>LinkedIn</title><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/></svg> </a><a rel="noopener noreferrer" href=https://www.facebook.com/manhhomienbienthuy target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>Facebook</title><path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"/></svg> </a><a rel="noopener noreferrer" href=https://github.com/manhhomienbienthuy target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>Github</title><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg> </a><a rel="noopener noreferrer" href=https://github.com/manhhomienbienthuy/manhhomienbienthuy.github.io/discussions target=_blank> <svg viewbox="0 0 24 24" class=size-6 fill=none stroke=currentColor xmlns=http://www.w3.org/2000/svg><title>Discussion</title><path d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z" stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg> </a><a rel="noopener noreferrer" href=https://github.com/manhhomienbienthuy/manhhomienbienthuy.github.io/issues target=_blank> <svg viewbox="0 0 16 16" class=size-6 fill=currentColor xmlns=http://www.w3.org/2000/svg><title>Issue</title><path d="M4.355.522a.5.5 0 0 1 .623.333l.291.956A4.979 4.979 0 0 1 8 1c1.007 0 1.946.298 2.731.811l.29-.956a.5.5 0 1 1 .957.29l-.41 1.352A4.985 4.985 0 0 1 13 6h.5a.5.5 0 0 0 .5-.5V5a.5.5 0 0 1 1 0v.5A1.5 1.5 0 0 1 13.5 7H13v1h1.5a.5.5 0 0 1 0 1H13v1h.5a1.5 1.5 0 0 1 1.5 1.5v.5a.5.5 0 1 1-1 0v-.5a.5.5 0 0 0-.5-.5H13a5 5 0 0 1-10 0h-.5a.5.5 0 0 0-.5.5v.5a.5.5 0 1 1-1 0v-.5A1.5 1.5 0 0 1 2.5 10H3V9H1.5a.5.5 0 0 1 0-1H3V7h-.5A1.5 1.5 0 0 1 1 5.5V5a.5.5 0 0 1 1 0v.5a.5.5 0 0 0 .5.5H3c0-1.364.547-2.601 1.432-3.503l-.41-1.352a.5.5 0 0 1 .333-.623zM4 7v4a4 4 0 0 0 3.5 3.97V7H4zm4.5 0v7.97A4 4 0 0 0 12 11V7H8.5zM12 6a3.989 3.989 0 0 0-1.334-2.982A3.983 3.983 0 0 0 8 2a3.983 3.983 0 0 0-2.667 1.018A3.989 3.989 0 0 0 4 6h8z"/></svg> </a></div></div></div></main><footer class="mt-8 text-white"><div class=bg-slate-800><div class="grid grid-cols-1 md:grid-cols-3 md:gap-8 container mx-auto px-4 leading-loose text-justify"><div class=py-8><a href=https://manhhomienbienthuy.github.io title=manhhomienbienthuy> <svg class="w-full h-auto text-white" viewbox="0 0 1000 165" fill=currentColor height=165 version=1.0 width=1000 xmlns=http://www.w3.org/2000/svg><path d="M651.5 14.7c-10.4 1-11.6 1.4-11 3.3.9 2.9-1.2 7-17.6 34.2-8.4 13.9-17.6 30.2-20.4 36.3-3.5 7.4-6.7 12.4-9.6 15.4-6.1 6.1-13.9 9.2-13.9 5.6 0-2.6 4.7-11 12.7-22.8C600.3 74 602 70.5 602 65.5c0-5.2-2.8-7.5-9-7.5-5.7 0-9.5 1.6-15.7 6.7-2.4 1.9-4.3 3.2-4.3 3 0-.3.7-2.1 1.5-4.1.9-2 1.3-4.1 1-4.6-.4-.6-3.7-1-7.6-1-6.9 0-6.9 0-6.9 2.8 0 3.1-8.1 17.8-14.9 27.2-5.8 8-17.3 18.7-22.5 21.1-11.4 5.2-15.8-1.8-9.3-15 2-4.1 2.7-4.6 7.7-5.8 11.9-2.9 24.9-11.3 28.5-18.4 2.1-4 1.9-9.2-.5-11.4-1.5-1.4-3-1.7-6.7-1.2-17.2 2-35.5 17.7-42.7 36.6-2.1 5.4-3.9 8.1-8.4 12.4-6.4 6.1-9.5 7.5-11.8 5.6-2.8-2.3-.9-7 9.2-23.5C500.2 71 505.5 60.6 504.5 59c-.8-1.2-8.5-1.3-11.7-.1-1.6.6-2.8 2.2-3.6 4.8-2 6.7-19.5 35.4-25 41.1-5.1 5.1-8.7 6.6-9.8 3.8-.6-1.7 3-9.1 9.6-19.6 12.6-20.1 14.1-27.7 6.1-31.9-4.6-2.5-13.9.9-20 7.3-1.9 2-3.9 3.6-4.3 3.6s-.8-1.6-.8-3.5c0-4.6-2.9-7.5-7.5-7.5-4.2 0-8.4 2-14.2 6.7l-4.2 3.5.9-3.2c1.4-5 .5-6-6-6-6.3 0-8.2 1.3-9.4 6.3-.6 2.7-17.1 33-24.7 45.4-2.2 3.5-3.9 6.6-3.9 6.8 0 .3 3.1.5 6.8.5h6.8l8.2-13.8c11.1-18.8 19.6-30.5 25.6-35.3 5.1-4.1 8.8-4.8 9.4-1.8.2.9-5.8 12.5-13.3 25.8-7.4 13.2-13.5 24.3-13.5 24.6s2.8.5 6.2.3l6.2-.3 13-20.8c13.2-20.9 20.3-29.9 25.2-31.7 7-2.7 5.7 3-5 21-7.7 12.9-11.6 21.6-11.6 25.8 0 2 5.5 7.2 7.7 7.2 3.9 0 9.5-2.2 13.8-5.5 2.5-1.9 4.7-3.5 5-3.5s.5 1.3.5 2.8c0 1.7 1 3.8 2.5 5.2 2.1 2 3.1 2.2 7.4 1.7 6.3-.7 10.2-2.8 16.2-8.4l4.7-4.4 1.1 3.4c.7 1.9 2.3 4.5 3.7 5.8 2.1 2 3.6 2.4 8.7 2.4 7.1 0 11.8-2.3 20-9.5 2.6-2.3 4.7-3.9 4.7-3.6s-1.3 2.7-3 5.3c-4.3 6.8-4.1 7.3 3.3 7.3h6.3l11.2-17.3c12.5-19.4 19.9-28.6 26.3-32.8 5.1-3.5 8.5-3.5 8.2-.1-.2 1.3-4.4 8.6-9.3 16.3-5 7.7-10 15.9-11.2 18.2-2.7 5.4-2.9 11.8-.4 14.6 4.4 4.8 16.5 1.1 25.6-8l4.8-4.8.6 3.8c1.3 8.3 8.3 12.4 17.3 10.2 18.5-4.6 39.3-28 39.3-44.3 0-14-8.6-18.8-20-11.1-5.5 3.7-5.5 3.7-3.6.8 5.6-8.5 23.6-41 24.1-43.6.8-3.7 0-4.6-4-4.2zM542.6 62.5c.3.8-.7 3.7-2.2 6.5-3.8 7-16.5 17-21.5 17-1.7 0 9-14.6 14.6-19.9 5.5-5.2 8.1-6.2 9.1-3.6zm101 3c1.9 7.8-15.7 39.6-25.6 46.3-2.2 1.4-4.6 2.2-6.5 2-2.6-.3-3-.7-3.3-3.6-.8-8.1 8.8-27.5 19.7-39.5 7-7.8 14.4-10.2 15.7-5.2zM821 16c-1.1 1.1-2 2.7-2 3.5 0 2.1-5.3 12.5-9.7 19.2l-3.6 5.3h-5.8c-5.6 0-5.9.1-5.9 2.4 0 2.2.5 2.5 4.4 2.8l4.4.3-11 18c-6 9.9-13 22-15.4 27-4.7 9.9-7.3 13-12.1 15.1-4.2 1.8-6.3 1.8-6.3-.1 0-2.6 4.7-11 12.7-22.8C779.3 74 781 70.5 781 65.5c0-5.2-2.8-7.5-9-7.5-5.7 0-9.5 1.6-15.7 6.7-2.4 1.9-4.3 3.2-4.3 3 0-.3.7-2.1 1.5-4.1.9-2 1.3-4.1 1-4.6-.4-.6-3.7-1-7.6-1-6.9 0-6.9 0-6.9 2.8 0 3.1-8.1 17.8-14.9 27.2-5.8 8-17.3 18.7-22.5 21.1-11.4 5.2-15.8-1.8-9.3-15 2-4.1 2.7-4.6 7.7-5.8 11.9-2.9 24.9-11.3 28.5-18.4 2.1-4 1.9-9.2-.5-11.4-1.5-1.4-3-1.7-6.7-1.2-17.2 2-35.5 17.7-42.7 36.6-2.1 5.4-3.9 8.1-8.4 12.4-6.4 6.1-9.5 7.5-11.8 5.6-2.8-2.3-.9-7 9.2-23.5C679.2 71 684.5 60.6 683.5 59c-.8-1.2-8.5-1.3-11.7-.1-1.6.6-2.8 2.3-3.6 4.9-.7 2.2-4.9 10-9.3 17.3-10.4 17-12.9 22.7-12.9 28.8 0 3.8.5 5.2 2.5 7.1 2.1 2 3.1 2.2 7.4 1.7 6.3-.7 10.2-2.8 16.2-8.4l4.7-4.4 1.1 3.4c.7 1.9 2.3 4.5 3.7 5.8 2.1 2 3.6 2.4 8.7 2.4 7.1 0 11.8-2.3 20-9.5 2.6-2.3 4.7-3.9 4.7-3.6s-1.3 2.7-3 5.3c-4.3 6.8-4.1 7.3 3.3 7.3h6.3l11.2-17.3c12.5-19.4 19.9-28.6 26.3-32.8 5.1-3.5 8.5-3.5 8.2-.1-.2 1.3-4.4 8.6-9.3 16.3-11.4 17.8-13.3 21.4-13.4 26.5-.2 10.4 11 11.4 23.4 2l3.5-2.7.8 3c2.1 8.2 12.3 8.2 22.8 0 4.4-3.5 5.6-3.7 3.5-.7-3.1 4.4-2.2 5.8 3.7 5.8 3.9 0 5.8-.5 6.9-1.8.9-.9 5.8-8.7 10.8-17.2 13.2-22 18-28.1 26-32.9 5.2-3.1 7-2.8 7 1.2 0 2.5-2.2 6.8-8.2 16.3-9.8 15.5-12.8 21.7-12.8 26.5 0 4.4 3.3 7.9 7.6 7.9 4.5 0 12.6-4.5 18.6-10.3l5.4-5.2-.4 5.2c-.5 6.3 1.3 9.8 5.7 10.8s9.5-1.7 17.1-9.1l6.9-6.6-.2 5.5c-.2 4.2.3 6 1.7 7.6 2.8 3.1 8.3 2.8 13.2-.7l3.9-2.8 2 3c1.1 1.6 3.1 3.3 4.5 3.6 3.8 1 11.1-1.5 15.8-5.5 2.3-2 4.2-3.4 4.2-3.1 0 1.2-10.4 19.3-13.5 23.6-4.7 6.4-14.3 15.4-19.3 17.9-4.7 2.4-10.9 2.7-13.7.8-1.6-1.2-1.6-1.8-.7-4.7 1.6-4.4 1.5-5.6-.4-7.4-3.8-3.8-10.4.2-10.4 6.3 0 11 18.9 13.3 36.9 4.5 11.2-5.5 20.6-15.4 29.7-31.4 3.9-6.9 10.6-18.4 14.9-25.5 16.8-28.2 19.1-32.6 18-34.5-.4-.6-3.5-1-7.1-1-5.3 0-6.6.3-7 1.7-.8 2.9-12.5 25.4-16.1 31.2-6.9 10.8-18.9 21.2-22.8 19.7-2.8-1 1.4-11 11-26.7 7.3-11.8 12.7-22.8 12.1-24.5-.6-1.5-4.4-1.8-9.5-.8-2.7.6-3.6 1.5-5.5 5.8-1.3 2.8-5.8 10.6-10 17.4-7.7 12.2-12.6 21.5-12.6 23.9 0 1.7-4.6 4.6-6 3.8-3.2-2 .2-11 10.4-27.8 7.7-12.8 11.5-20.1 11.6-22.5 0-.8-1.4-1.2-4.2-1.1-9.3.3-9.7.6-13.8 10.2-6.6 15.4-24.1 39.3-30.4 41.7-2.9 1-4.6.2-4.6-2.4 0-1.2 3.9-8.7 8.6-16.7C900 63.4 901.8 58 894.5 58c-6.7 0-9.5 1.1-10 3.9-2.4 12.1-24.9 42.1-34.6 46.1-7.4 3.1-5.5-3.2 6.1-20.5 8.5-12.6 10-15.9 10-21.8 0-9.6-10.3-11.3-20.9-3.6-2.4 1.7-4.4 2.9-4.6 2.7s4.2-7.7 9.7-16.8c13.2-21.9 16.4-28.5 14.7-30.6-1-1.2-2.4-1.5-6.1-1-6.7.9-7.5 1.4-8.3 4.4-.3 1.5-2.3 5.6-4.5 9.2-2.1 3.6-7.5 13-12 21-28.3 50.1-35.9 60.5-43.8 59.8-5-.4-5.2-2.6-1.2-12.1 3.3-8.1 16.2-30.6 24.2-42.5l4.9-7.2h5.4c5.2 0 5.5-.1 5.5-2.5 0-2.3-.4-2.5-4-2.5-2.2 0-4-.2-4-.6 0-.3 1.8-3.2 4-6.4 5-7.4 11-18.9 11-21.3 0-2.7-12.2-2.5-15 .3zm-99.4 46.5c.3.8-.7 3.7-2.2 6.5-3.8 7-16.5 17-21.5 17-1.7 0 9-14.6 14.6-19.9 5.5-5.2 8.1-6.2 9.1-3.6zM271.5 16.5c-.5.2-2.2.6-3.7.9-1.6.4-2.8 1.2-2.8 1.9 0 1.7-2.4 6.2-12.9 24.7-18.8 33.1-33.6 57.7-36.5 60.9-4.7 5.1-12.6 8-12.6 4.6 0-2.6 4.7-11 12.7-22.8C224.3 74 226 70.5 226 65.5c0-5.2-2.8-7.5-9-7.5-5.7 0-9.5 1.6-15.7 6.7-2.4 1.9-4.3 3.2-4.3 3 0-.3.7-2.1 1.5-4.1.9-2 1.3-4.1 1-4.6-.4-.6-3.7-1-7.6-1-6.9 0-6.9 0-6.9 2.8 0 5.5-20.8 38.1-29.4 46-4.8 4.4-7 5.2-7.9 2.8-1-2.5 1-7.5 7.2-18 8.4-14.3 18.1-31.8 18.1-32.8 0-.4-2.9-.8-6.5-.8s-6.5.4-6.5.8c0 .5-.6 1.6-1.3 2.6-1.3 1.8-1.5 1.7-4.1-.9-2.4-2.4-3.4-2.7-7-2.3-13.6 1.6-31.1 16.8-39.7 34.5-5.8 11.8-16.5 21-18.5 15.9-.6-1.7 3-9.1 9.6-19.6 12.6-20.1 14.1-27.7 6.1-31.9-4.6-2.5-13.9.9-20 7.3-1.9 2-3.9 3.6-4.3 3.6s-.8-1.6-.8-3.5c0-4.6-2.9-7.5-7.5-7.5-4.2 0-8.4 2-14.2 6.7l-4.2 3.5.9-3.2c1.4-5 .5-6-6-6-6.3 0-8.2 1.3-9.4 6.3-.6 2.7-17.1 33-24.7 45.4-2.2 3.5-3.9 6.6-3.9 6.8 0 .3 3.1.5 6.8.5h6.8l8.2-13.8c11.1-18.8 19.6-30.5 25.6-35.3 5.1-4.1 8.8-4.8 9.4-1.8.2.9-5.8 12.5-13.3 25.8-7.4 13.2-13.5 24.3-13.5 24.6s2.8.5 6.2.3l6.2-.3 13-20.8C79.6 74.8 86.7 65.8 91.6 64c7-2.7 5.7 3-5 21C78.9 97.9 75 106.6 75 110.8c0 .7 1.4 2.7 3 4.4 2.8 2.7 3.5 3 7.1 2.4 5.4-.9 9.2-2.9 14.4-7.7l4.3-3.9.7 3.6c.3 2.1 2 5 3.6 6.7 2.5 2.5 3.6 2.9 6.4 2.4 3.8-.6 9.8-4.5 16.4-10.6 2.4-2.3 4.5-4.1 4.7-4.1s.4 2.2.4 5c0 6.2 2.7 9.6 6.8 8.5 3.5-.9 8.2-3.1 11.1-5.2 2.4-1.7 2.4-1.7 1.3.4-2.1 3.8-1.5 4.3 5.1 4.3h6.3l11.2-17.3c12.5-19.4 19.9-28.6 26.3-32.8 5.1-3.5 8.5-3.5 8.2-.1-.2 1.3-4.4 8.6-9.3 16.3-11.4 17.8-13.3 21.4-13.4 26.5-.2 8.3 7.1 10.9 16.7 6 4.4-2.2 4.7-2.2 4.7-.5 0 1.6.8 1.9 5.3 1.9 3.9 0 5.8-.5 6.9-1.8.9-.9 5.8-8.7 10.8-17.2 13.2-22 18-28.1 26-32.9 5.2-3.1 7-2.8 7 1.2 0 2.5-2.2 6.8-8.2 16.3-13.4 21.3-15.4 27.6-10.3 32.4 4.2 3.9 12 1.6 22.4-6.7l3.5-2.8-2.7 4c-4.2 6.2-3.7 7.5 2.6 7.5 3.9 0 5.8-.5 6.9-1.8.9-.9 5.8-8.7 10.8-17.2 13.2-22 18-28.1 26-32.9 5.2-3.1 7-2.8 7 1.2 0 2.5-2.2 6.8-8.2 16.3-13.3 21.1-15.4 27.6-10.5 32.2 4.5 4.3 12 2 22.5-6.7 5.6-4.7 6.2-5 6.2-2.9 0 3.7 3.4 8.3 7.6 10.3 14.4 7 36.7-6.2 47.5-28 4-8 4.4-9.5 4.4-16.1 0-6.3-.3-7.6-2.4-9.8-8.4-8.9-26.6-4-42.2 11.5-6.3 6.2-8.5 9.2-12.2 17-3.4 7.1-5.7 10.3-9.1 13.1-5.7 4.8-9.3 6.5-10.7 5.1-1.6-1.6 1.6-8.1 10.1-20.8 8.5-12.6 10-15.9 10-21.8 0-9.6-10.3-11.3-20.9-3.6-2.4 1.7-4.4 2.9-4.6 2.7s4.2-7.7 9.7-16.8c13.2-21.9 16.4-28.5 14.7-30.6-2-2.4-13.9-.7-13.9 2S293.2 74.5 284 88c-5 7.3-16 18.3-20.1 20-7.4 3.1-5.6-3.1 6.1-20.5 8.5-12.6 10-15.9 10-21.8 0-9.6-10.3-11.3-20.9-3.6-2.4 1.7-4.4 2.9-4.6 2.7s4.2-7.7 9.7-16.8c13-21.5 16.4-28.5 14.8-30.5-1.1-1.4-4.9-1.9-7.5-1zM151.8 62.2c3.2 3.2-.1 12.6-10.1 28.1-8.9 13.8-16.1 20.7-21.6 20.7-2.7 0-4.4-3.4-3.5-7.3 2.3-11.1 21.5-37.5 29.9-41.3 3.7-1.7 3.8-1.7 5.3-.2zm232 0c3.5 3.5-1 17.8-9.8 31.1-10.1 15.4-20.3 22.2-25.5 17-6.8-6.7 12.9-39 29-47.6 3.7-2 4.7-2.1 6.3-.5z"/><path d="M505.6 33c-6.8 8.1.3 14.8 7.8 7.3 2.1-2.1 2.6-3.5 2.4-6.2-.3-3.3-.6-3.6-3.9-3.9-3-.3-4.1.2-6.3 2.8zM684.6 33c-6.8 8.1.3 14.8 7.8 7.3 2.1-2.1 2.6-3.5 2.4-6.2-.3-3.3-.6-3.6-3.9-3.9-3-.3-4.1.2-6.3 2.8z"/></svg> </a><div class="flex items-center mb-4 gap-4"><img class="size-16 rounded-full" alt=manhhomienbienthuy height=56 src=https://manhhomienbienthuy.github.io/meow.webp width=56><p>manhhomienbienthuy | naa<br> salaried programmer</div></div><div class=py-8><p class=mb-4>Trang web này được viết bằng tất cả ♥ và tinh thần của tôi, dành tặng cho yunachan – tình yêu của tôi.<p class=mb-4>Mã HTML được built bởi Pelican, sử dụng Python-Markdown, Pygments và nhiều công cụ khác.<p class=mb-4>Nội dung trang web này được cấp phép theo giấy phép <a rel="noopener noreferrer" class=font-bold href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a>. Mã nguồn được cấp phép theo giấy phép <a rel="noopener noreferrer" class=font-bold href=https://github.com/manhhomienbienthuy/manhhomienbienthuy.github.io/blob/main/LICENSE target=_blank>MIT License</a>.</div><div class=py-8><p class=mb-4>Nhiều bài viết của tôi được thực hiện từ lâu, nội dung của chúng có thể đã lỗi thời. Suy nghĩ của tôi nhiều khi đã thay đổi và tôi có thể sẽ tiếp cận theo cách khác nếu viết bài vào thời điểm hiện tại. Dù vậy, tôi ít khi sửa lại nội dung bài viết cũ mà chỉ sữa lỗi typo. Nếu nội dung có gì cập nhật, tôi sẽ chú thích trong bài.</div></div></div><div class=bg-slate-900><div class="flex flex-wrap justify-between container mx-auto px-4"><div class="pt-4 md:py-4">Copyright © 2010–2025 <a class=font-bold href=https://manhhomienbienthuy.github.io/pages/gioi-thieu.html> manhhomienbienthuy </a></div><div class="grow py-4 text-right divide-x"><a class=px-2 href=https://manhhomienbienthuy.github.io> Trang chủ </a><a class=px-2 href=https://manhhomienbienthuy.github.io/pages/gioi-thieu.html> Giới thiệu </a><a class=px-2 href=https://manhhomienbienthuy.github.io/pages/computer-info.html> Computer Info </a></div></div></div></footer><script defer src=https://manhhomienbienthuy.github.io/theme/js/app.js></script>